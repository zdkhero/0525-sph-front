# å°šå“æ±‡ç¬¬ 2 å¤©



## 1. æ‹†åˆ† Vuex æ¨¡å—



**æ€è·¯åˆ†æï¼š**

> ç”±äºä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ä¼šé›†ä¸­åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¯¹è±¡ã€‚å½“åº”ç”¨å˜å¾—éå¸¸å¤æ‚æ—¶ï¼Œstore å¯¹è±¡å°±æœ‰å¯èƒ½å˜å¾—ç›¸å½“è‡ƒè‚¿ã€‚



åœ¨æˆ‘ä»¬é¡¹ç›®ä¸­ï¼Œéœ€è¦é€šè¿‡ `Vuex` å­˜å‚¨å¤šä¸ªæ•°æ®ï¼Œå¦‚æœæŠŠæ‰€æœ‰çš„çŠ¶æ€éƒ½å­˜æ”¾åœ¨ `State` ä¸­ï¼Œå½“é¡¹ç›®å˜å¾—è¶Šæ¥è¶Šå¤§çš„æ—¶å€™ï¼Œ`Vuex` ä¼šå˜å¾—è¶Šæ¥è¶Šéš¾ä»¥ç»´æŠ¤ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ä½¿ç”¨ `Vuex` æä¾›æ¨¡å—åŒ–ï¼Œå°†çŠ¶æ€æŒ‰ç…§åŠŸèƒ½æ¨¡å—è¿›è¡Œåˆ’åˆ†ã€‚



<img src="./images/2-1 Vuex.png" style="zoom:80%; border: 1px solid #ccc" />





**å®ç°æ­¥éª¤ï¼š**



1. åœ¨ `store` ç›®å½•ä¸‹åˆ›å»º `modules` æ–‡ä»¶å¤¹ï¼Œç”¨æ¥ç»Ÿä¸€ç®¡ç†é¡¹ç›®ä¸­æ‹†åˆ†çš„æ¨¡å—
2. åœ¨ `modules`  ç›®å½•ä¸‹åˆ›å»º `home.js` å’Œ `user.js` æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–æ–‡ä»¶
3. å°†æ–‡ä»¶åœ¨ `store/index.js` æ–‡ä»¶ä¸­å¯¼å…¥å¹¶æ³¨å†Œ



**è½åœ°ä»£ç ï¼š**



1. åˆ›å»º `modules` æ–‡ä»¶å¤¹å’Œ  `home.js` å’Œ `user.js` æ¨¡å—

2. åˆ›å»º `home.js` å’Œ `user.js` æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–æ–‡ä»¶

   ```js
   // home.js
   const state = {
     categoryList: []
   }
   
   const getters = {}
   const mutations = {}
   const actions = {}
   
   export default {
     namespaced: true,
     state,
     getters,
     mutations,
     actions
   }
   
   ```

   

   ```js
   // user.js 
   
   const state = {
     userInfo: {} // ç”¨æˆ·æ•°æ®
   }
   
   const getters = {}
   const mutations = {}
   const actions = {}
   
   export default {
     namespaced: true,
     state,
     getters,
     mutations,
     actions
   }
   
   ```

   

3. å°†æ–‡ä»¶åœ¨ `store/index.js` æ–‡ä»¶ä¸­å¯¼å…¥å¹¶æ³¨å†Œ

   ```js
   import Vue from 'vue'
   import Vuex from 'vuex'
   
   // å¯¼å…¥é¦–é¡µæ¨¡å—
   import home from './modules/home'
   // å¯¼å…¥ç”¨æˆ·æ¨¡å—
   import user from './modules/user'
   
   Vue.use(Vuex)
   
   export default new Vuex.Store({
     modules: {
       home,
       user
     }
   })
   
   ```







## 2. å°†ä¸‰çº§åˆ†ç±»æ•°æ®å­˜å‚¨åˆ° Vuex



**æ€è·¯åˆ†æï¼š**



è¿›å…¥é¦–é¡µçš„æ—¶å€™ï¼Œå°±éœ€è¦å±•ç¤ºä¸‰çº§åˆ†ç±»ï¼Œæˆ‘ä»¬å°†æ•°æ®å­˜å‚¨åˆ° Vuex ä¸­ï¼ŒæŒ‰ç…§ Vuex ä¸­ä½¿ç”¨çš„æµç¨‹ï¼Œä»åç«¯æœåŠ¡å™¨è·å–åˆ°æ•°æ®å±äºå¼‚æ­¥ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨ç»„ä»¶ä¸­é€šè¿‡ dispatch è°ƒç”¨ actions æ–¹æ³•



éœ€è¦æ³¨æ„çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®åç«¯è¿”å›çš„ä¸šåŠ¡é€»è¾‘åˆ¤æ–­æ˜¯å¦éœ€è¦èµ‹å€¼

> ğŸ“Œ Tipï¼š
>
> æ³¨æ„åŒºåˆ†ï¼šå“åº”æˆåŠŸ  å’Œ  ä¸šåŠ¡é€»è¾‘æˆåŠŸ
>
> ä¸¾ä¾‹1ï¼šç™»å½•ç³»ç»Ÿï¼Œè‹¥ç”¨æˆ·åå¯†ç æ­£ç¡®ï¼ŒæœåŠ¡å™¨è¿”å›ç™»å½•æˆåŠŸï¼Œè¿™æ˜¯ï¼šå“åº”æˆåŠŸã€ä¸šåŠ¡é€»è¾‘ä¹ŸæˆåŠŸã€‚
>
> ä¸¾ä¾‹2ï¼šç™»å½•ç³»ç»Ÿï¼Œè‹¥å¯†ç è¾“å…¥é”™è¯¯ï¼ŒæœåŠ¡å™¨è¿”å›ç™»å½•å¤±è´¥ï¼Œè¿™æ˜¯ï¼šå“åº”æˆåŠŸã€ä¸šåŠ¡é€»è¾‘å´å¤±è´¥ã€‚
>
> ä¸¾ä¾‹3ï¼šç™»å½•ç³»ç»Ÿï¼ŒæœåŠ¡å™¨ç¹å¿™ï¼Œæ— æ³•åšå‡ºå“åº”ï¼Œè¿™æ˜¯ï¼šå“åº”å¤±è´¥ï¼Œä¸šåŠ¡é€»è¾‘å¿…å®šå¤±è´¥ã€‚



**å®ç°æ­¥éª¤ï¼š**



1. å°è£…è·å–ä¸‰çº§åˆ†ç±»æ•°æ®çš„æ¥å£ `api`
2. åœ¨ `state` ä¸­å®šä¹‰ä¸‰çº§åˆ†ç±»çš„çŠ¶æ€
3. å®šä¹‰ `actions` æ–¹æ³•ï¼Œå¤„ç†å¼‚æ­¥çš„é€»è¾‘
4. å®šä¹‰ `mutations` æ–¹æ³•ï¼Œå¯¹æ•°æ®è¿›è¡Œå˜æ›´
5. åœ¨ç»„ä»¶ä¸­é€šè¿‡ `dispatch` æˆ–è€… `mapActions` è°ƒç”¨ `action` æ–¹æ³•



**è½åœ°ä»£ç ï¼š**



1. å°è£…è·å–ä¸‰çº§åˆ†ç±»æ•°æ®çš„æ¥å£ `api`

   ```js
   // å¯¼å…¥å°è£…çš„ç½‘ç»œè¯·æ±‚å·¥å…· request.js
   import request from '@/utils/request'
   
   /**
    * @description è¯·æ±‚ä¸‰çº§åˆ†ç±»åˆ—è¡¨çš„å‡½æ•°
    * @param å‚æ•°
    * @returns Promise
    */
   export const reqCategoryList = () => request.get('/api/product/getBaseCategoryList')
   
   ```

   

2. åœ¨ `state` ä¸­å®šä¹‰ä¸‰çº§åˆ†ç±»çŠ¶æ€ï¼Œå®šä¹‰ `actions` ã€ `mutations` æ–¹æ³•ï¼Œå¤„ç†å¼‚æ­¥å’Œå˜æ›´æ•°æ®

   ```js
   import { reqCategoryList } from '@/api/index'
   
   const state = {
     categoryList: [] // ä¸‰çº§åˆ†ç±»æ•°æ®
   }
   
   const getters = {}
   
   const mutations = {
     // æ›´æ–°ä¸‰çº§åˆ†ç±»æ•°æ®
     saveGategoryList(state, list) {
       state.categoryList = list
     }
   }
   
   const actions = {
     // è·å–ä¸‰çº§åˆ†ç±»åˆ—è¡¨æ•°æ®
     async getCategoryList(context) {
       // è°ƒç”¨ reqCategoryList api è·å–æ•°æ®
       const res = await reqCategoryList()
       console.log(res)
       // åˆ¤æ–­ä¸šåŠ¡é€»è¾‘æ˜¯å¦æˆåŠŸ
       if (res.code === 200) {
         // è‹¥ä¸šåŠ¡é€»è¾‘æˆåŠŸï¼Œæ›´æ–°æ•°æ®
         context.commit('saveGategoryList', res.data)
       } else {
         // è‹¥ä¸šåŠ¡é€»è¾‘å¤±è´¥ï¼Œæç¤ºåŸå› 
         alert(res.message)
       }
     }
   }
   
   export default {
     namespaced: true,
     state,
     getters,
     mutations,
     actions
   }
   
   ```

   

3. åœ¨ç»„ä»¶ä¸­é€šè¿‡ `dispatch` æˆ–è€… `mapActions` è°ƒç”¨ `action` æ–¹æ³•

   ```vue
   <script>
   import { mapActions } from 'vuex'
   
   export default {
     name: 'TypeNav',
     mounted() {
       // ç¬¬ä¸€ç§ä½¿ç”¨ dispatch æ–¹å¼
       // this.$store.dispatch('home/getCategoryList')
       
       // ç¬¬äºŒç§å€ŸåŠ© mapActions æ˜ å°„å‡½æ•°
       this.getCategoryList()
     },
     methods: {
       ...mapActions('home', ['getCategoryList'])
     }
   }
   </script>
   ```

   









## 3. åŠ¨æ€å±•ç¤ºä¸‰çº§åˆ†ç±»



**æ€è·¯åˆ†æï¼š**



è·å–åˆ°æ•°æ®åï¼Œéœ€è¦å°†è¿”å›çš„æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ï¼Œæ­¤æ—¶éœ€è¦ä» Vuex ä¸­è·å–åˆ°æ•°æ®ï¼Œè·å–æ•°æ®æ•°æ®çš„æ–¹å¼æœ‰ä»¥ä¸‹ä¸¤ç§:



1. é€šè¿‡å®ä¾‹çš„æ–¹å¼è·å–
2. é€šè¿‡è¾…åŠ©å‡½æ•°çš„æ–¹å¼è·å–(åœ¨é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è¾…åŠ©å‡½æ•° `mapState` æ¥è¿›è¡Œæ•°æ®çš„è·å–å’Œæ¸²æŸ“)



ç»„ä»¶ä¸­è·å–åˆ°æ•°æ®åï¼Œä½¿ç”¨ `v-for` çš„æ–¹å¼å¯¹åç«¯è¿”å›çš„æ•°æ®è¿›è¡Œæ¸²æŸ“



**å®ç°æ­¥éª¤ï¼š**



1. åˆ©ç”¨è¾…åŠ©å‡½æ•°è·å–æ•°æ®
2. ä½¿ç”¨ v-for å¯¹æ•°ç»„è¿›è¡Œéå†ï¼Œäº§å‡ºé¡µé¢



**è½åœ°ä»£ç ï¼š**



1. è·å–åˆ°ä¸‰çº§åˆ†ç±»æ•°æ®

   ```js
   // 1. å€ŸåŠ©è¾…åŠ©å‡½æ•°
   computed: {
     ...mapState('home', ['categoryList'])
   }
   
   // 2. ä½¿ç”¨å‘½åç©ºé—´çš„æ–¹å¼
   computed: {
     ...mapState({
       categoryList: (state) => state.home.categoryList
     })
   }
   ```

   

2. åˆ©ç”¨ v-for å¯¹æ•°ç»„è¿›è¡Œéå†

   ```vue
   <div class="nav-left">
     <h2 class="all">å…¨éƒ¨å•†å“åˆ†ç±»</h2>
     <div class="sort">
       <div class="all-sort-list2">
         <div class="item" v-for="cate1 in categoryList" :key="cate1.categoryId">
           <h3>
             <a href="">{{ cate1.categoryName }}</a>
           </h3>
           <div class="item-list clearfix">
             <div class="subitem" v-for="cate2 in cate1.categoryChild" :key="cate2.categoryId">
               <dl class="fore">
                 <dt>
                   <a href="">{{ cate2.categoryName }}</a>
                 </dt>
                 <dd>
                   <!-- æ¯ä¸€ä¸ªä¸‰çº§åˆ†ç±» -->
                   <em v-for="cate3 in cate2.categoryChild" :key="cate3.categoryId">
                     <a href="">{{ cate3.categoryName }}</a>
                   </em>
                 </dd>
               </dl>
             </div>
           </div>
         </div>
       </div>
     </div>
   </div>
   ```







## 4. åŠ¨æ€å±•ç¤º Footer ç»„ä»¶



**æ€è·¯åˆ†æï¼š**



äº§å“éœ€æ±‚ï¼šç™»å½•ç»„ä»¶ï¼ˆ`Login`ï¼‰ã€æ³¨å†Œç»„ä»¶ï¼ˆ`Register`ï¼‰ï¼Œä¸å±•ç¤ºåº•éƒ¨çš„`Footer`ç»„ä»¶



å¦‚æœæƒ³æ§åˆ¶ `Footer`ç»„ä»¶çš„éšè—å’Œå±•ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è·¯ç”±è¿›è¡Œç›‘å¬ï¼Œä¾‹å¦‚ï¼š

```vue
<!-- åº•éƒ¨åŒºåŸŸ -->
<Footer v-if="$route.path !== '/login' && $route.path !== '/register'" />
```



è¿™ç§æ–¹å¼å¯ä»¥ç”¨äºé€»è¾‘æ¯”è¾ƒç®€å•çš„åˆ¤æ–­ï¼Œå¦‚æœéœ€è¦å¯¹ N ä¸ªç»„ä»¶è¿›è¡Œåˆ¤æ–­å°±æ¯”è¾ƒéº»çƒ¦ï¼Œåªèƒ½é€šè¿‡è®¡ç®—å±æ€§ã€watch å†™å¾ˆå¤šçš„é€»è¾‘ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è·¯ç”±æä¾›çš„ è·¯ç”±å…ƒä¿¡æ¯ `meta` æ¥è¿›è¡Œå¤„ç†ï¼Œåªéœ€è¦ç»™è·¯ç”±é…ç½® `meta` å±æ€§ï¼Œæ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„å­—æ®µå³å¯

```js
{
  path: '/login',
  component: Login,
  meta: {
    isShowFooter: true
  }
},
{
  path: '/register',
  component: Register,
  meta: {
    isShowFooter: true
  }
}
```





**å®ç°æ­¥éª¤ï¼š**



1. ç»™ `Login` å’Œ `Register` è·¯ç”±æ·»åŠ  `meta` å±æ€§
2. åœ¨ `meta` å±æ€§ä¸­æ·»åŠ  `isShowFooter` å­—æ®µï¼Œç”¨äºå†³å®š`Footer` ç»„ä»¶çš„éšè—å’Œå±•ç¤º
3. ç»™ `Footer` ç»„ä»¶æ ‡ç­¾æ·»åŠ  `v-if` æŒ‡ä»¤ï¼Œæ§åˆ¶`Footer` ç»„ä»¶çš„éšè—å’Œå±•ç¤º

 

**è½åœ°ä»£ç ï¼š**



1. `router/index.js`

   ```js
   const routes = [
     // coding......
   
     {
       path: '/login',
       component: Login,
       meta: {
         isShowFooter: true
       }
     },
     {
       path: '/register',
       component: Register,
       meta: {
         isShowFooter: true
       }
     },
       
     // coding......
   ]
   
   ```

   

2. `App.vue`ç»„ä»¶

   ```vue
   <Footer v-if="!$route.meta.isShowFooter" />
   ```







## 5. è·³è½¬åˆ°æœç´¢



### 5.1  è·³è½¬æ–¹å¼åˆ†æ



å®ç°è·³è½¬çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š

1. ç¬¬ä¸€ç§å†™æ³•ï¼šæŠŠåˆ†ç±»é“¾æ¥çš„ `<a>`æ”¹ä¸º`<router-link>` â€”â€”  ä¸æ¨èï¼Œå¾ˆå å†…å­˜ã€‚
2. ç¬¬äºŒç§å†™æ³•ï¼šä¾ç„¶å†™```<a>```ï¼Œé äº‹ä»¶å§”æ´¾å®ç°è·³è½¬ â€”â€” æ¨èï¼ŒèŠ‚çº¦å†…å­˜ã€‚



**ç¬¬ä¸€ç§å†™æ³•æ€è·¯åˆ†æï¼š**



ç›®å‰é¡µé¢è·³è½¬çš„æ–¹å¼ï¼Œä½¿ç”¨çš„è¿˜æ˜¯ a æ ‡ç­¾

```vue
<a href="">{{ cate1.categoryName }}</a>
```



æ€è€ƒï¼šèƒ½å¤Ÿå°† `a` æ ‡ç­¾æ”¹ä¸º `<router-link />` â“

å›ç­”ï¼šä¸èƒ½ â—  

1. `<router-link />` æœ¬èº«æ˜¯å†…ç½®çš„ä¸€ä¸ªç»„ä»¶ï¼Œå¦‚æœå°† `a` æ ‡ç­¾æ”¹ä¸º `<router-link />`ï¼Œ

â€‹			é€šè¿‡å¯¹ä¸‰çº§åˆ†ç±»çš„éå†ï¼Œåœ¨é¡µé¢ä¸Šä¼šå‡ºç°å‡ ç™¾ä¸ª `<router-link />` ç»„ä»¶ï¼Œé€šè¿‡è°ƒè¯•å·¥å…·è¿›è¡ŒæŸ¥çœ‹

2. ç»„ä»¶æœ¬èº«æ˜¯ä¸€ä¸ªä¸ªå®ä¾‹ï¼Œä½¿ç”¨äº†ç»„ä»¶ï¼Œåœ¨åº•å±‚éœ€è¦ `new` ä¸€ä¸ªä¸ªæ„é€ å‡½æ•°ï¼Œå†…å­˜æ¶ˆè€—å¾ˆå¤§ï¼Œå› æ­¤è¿™é‡Œä¸èƒ½æ”¹ä¸ºè·¯ç”±æ ‡ç­¾



<img src="./images/2-2 router-link.png" style="zoom:50%; border: 1px solid #ccc" />





**ç¬¬äºŒç§å†™æ³•æ€è·¯åˆ†æï¼š**



ä½¿ç”¨å§”æ‰˜çš„æ–¹å¼è¿›è¡Œå®ç°ï¼Œéœ€è¦å§”æ‰˜ç»™å…±åŒçš„çˆ¶çº§ï¼Œå› æ­¤å¯ä»¥é€‰æ‹© `<div class="all-sort-list2">` æ ‡ç­¾

```vue
<div class="all-sort-list2" @click="toSearch">
  <div class="item" v-for="cate1 in categoryList" :key="cate1.categoryId">
    <!-- coding...... -->
  </div>
</div>
```





**å®ç°æ­¥éª¤ï¼š**



1. ç»™ `<div class="all-sort-list2">` æ ‡ç­¾ç»‘å®šç‚¹å‡»äº‹ä»¶
2. åœ¨äº‹ä»¶å¤„ç†ç¨‹åºé€šè¿‡ç¼–ç¨‹å¼å¯¼èˆªå®ç°é“¾æ¥è·³è½¬



**è½åœ°ä»£ç ï¼š**



```vue
<div class="all-sort-list2" @click="toSearch">
  <div class="item" v-for="cate1 in categoryList" :key="cate1.categoryId">
    <!-- coding...... -->
  </div>
</div>
```

```js
<script>
export default {
  methods: {
    toSearch() {
      this.$router.push('/search')
    }
  }
}
</script>
```









### 5.2  æºå¸¦å‚æ•°åˆ†æ



**æ€è·¯åˆ†æï¼š**



![](./images/2-3 ä¼ å‚.png)

<img src="./images/2-4 å‚æ•°åˆ†æ.png" style="zoom:80%; border: 1px solid #ccc" />



æ ¹æ®æ¥å£æ–‡æ¡£å’Œäº§å“çš„éœ€æ±‚åˆ†æï¼Œè·³è½¬ä¼ é€’åˆ° Search é¡µé¢éœ€è¦ä¼ é€’ 2 ä¸ªå‚æ•°

```shell
# åˆ†ç±»çš„åå­— categoryName
# åˆ†ç±»çš„ id  category1Id(ä¸€çº§åˆ†ç±» ID)  category2Id(äºŒçº§åˆ†ç±» ID)  category3Id(ä¸‰çº§åˆ†ç±» ID)
categoryName=ç‡ƒæ°”ç¶&category3Id=100
```



`åˆ†ç±»id` å’Œ `åˆ†ç±»çº§åˆ«` å¦‚ä½•ä¼ é€’å‚æ•°ï¼šâ“



1. ç»™ç»‘å®šçš„äº‹ä»¶æºå¸¦ä¸Šå‚æ•°ï¼Ÿæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯äº‹ä»¶å§”æ‰˜ï¼Œæ— æ³•å°†æ•°æ®ä¼ é€’ç»™çˆ¶çº§ï¼
2. ç»™éœ€è¦è·³è½¬çš„æ ‡ç­¾æºå¸¦ä¸Šè‡ªå®šä¹‰å±æ€§ï¼Ÿé€šè¿‡ `e.target.attributes` è·å–å‚æ•°ï¼Œä½†æ˜¯éœ€è¦è‡ªå·±å¤„ç†ï¼
3. ç»™éœ€è¦è·³è½¬çš„æ ‡ç­¾æºå¸¦ä¸Š `data-` å¼€å¤´çš„è‡ªå®šä¹‰å±æ€§ï¼Ÿé€šè¿‡ `e.target.dataset`è·å–å‚æ•°ï¼Œé€‰æ‹©è¿™ç§ï¼



```html
<body>
    
  <div>
    <button a="1" b="2" data-c="123" data-d="456">è·å–å‚æ•°</button>
  </div>

  <script>
    window.onload = function () {
      const box = document.querySelector('div')

      box.addEventListener('click', function (e) {
        // console.dir(e.target.attributes)
        console.dir(e.target.dataset)
      })

    }
  </script>
</body>
```





**å®ç°æ­¥éª¤ï¼š**



1. ç»™æ¯å¯¼èˆªé‡Œçš„åˆ†ç±»åŠ 2ä¸ªè‡ªå®šä¹‰å±æ€§ï¼š`data-level`ã€`data-id`
2. åˆ†ç±»åç§°ï¼Œä½¿ç”¨ï¼š`event.target.innerText`è·å–
3. åˆ†ç±»åç§°ã€åˆ†ç±»ç¼–å·ï¼Œä½¿ç”¨ï¼š`event.target.dataset.xxx`è·å–



**è½åœ°ä»£ç ï¼š**



1. ç»™æ¯å¯¼èˆªé‡Œçš„åˆ†ç±»åŠ 2ä¸ªè‡ªå®šä¹‰å±æ€§ï¼š`data-level`ã€`data-id`

   ```vue
   <!-- ä¸€çº§åˆ†ç±» -->
   <a data-level="1" :data-id="c1.categoryId">{{c1.categoryName}}</a>
   <!-- äºŒçº§åˆ†ç±» -->
   <a data-level="2" :data-id="c2.categoryId">{{c2.categoryName}}</a>
   <!-- ä¸‰çº§åˆ†ç±» -->
   <a data-level="3" :data-id="c3.categoryId">{{c3.categoryName}}</a>
   ```

   

2. ä½¿ç”¨`event.target.innerText`è·å–åˆ†ç±»åç§°ï¼Œä½¿ç”¨`event.target.dataset.xxx`åˆ†ç±»åç§°å’Œç¼–å·

   ```js
     methods: {
       toSearch(e) {
         // è·å–åˆ°ç‚¹å‡»åˆ†ç±»çš„ï¼šåˆ†ç±»çº§åˆ«ã€åˆ†ç±»ç¼–å·ã€åˆ†ç±»åç§°
         const { level, id } = e.target.dataset
         const { innerText } = e.target
         
         // åˆ¤æ–­ç‚¹å‡»çš„æ˜¯å¦ä¸ºåˆ†ç±»
         if (level) {
           // åˆ†ç±»åç§°
           console.log(level, id, innerText)
         }
       }
     },
   ```







### 5.3 æºå¸¦å‚æ•°è·³è½¬



**æ€è·¯åˆ†æï¼š**



1. æºå¸¦å‚æ•°çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š`params` ä¼ å‚ã€`query` ä¼ å‚ï¼Œè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ query ä¼ å‚çš„æ–¹å¼ï¼Œ
2. éœ€è¦æºå¸¦çš„å‚æ•°æœ‰ä¸¤ä¸ª `åˆ†ç±»åå­—` ã€`åˆ†ç±»çš„ ID`
   - ä¼ é€’ ID çš„å±æ€§ï¼Œæ ¼å¼ä¸ºï¼š`category1Id`ã€`category2Id`ã€ `category3Id`
   - ä¸»è¦æ˜¯ä¸ºäº†ä»¥åè·å–æ•°æ®ã€ä½¿ç”¨æ•°æ®æ–¹ä¾¿



æ€è€ƒï¼šå¦‚ä½•å¤„ç† key ï¼Œå¦‚ä½•è¿›è¡Œæ‹¼æ¥â“ 

å›ç­”ï¼š`[category${level}Id]:id`



>  ğŸ“Œ Tipï¼š
>
> â€‹	 `[category${level}Id]`ï¼Œè¿™ç§å†™æ³•å¹¶ä¸æ˜¯æ•°ç»„ ï¼ï¼ï¼ï¼
>
> â€‹	  æˆ‘ä»¬å¯ä»¥ç§°ä¸ºï¼šä¸­æ‹¬å·è¿ç®—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸­æ‹¬å·è¿ç®—ç¬¦è®¾ç½®å€¼ã€è·å–å€¼
>
> â€‹	  ä¸­æ‹¬å·è¿ç®—ç¬¦å¯ä»¥ç”¨ã€å­—ç¬¦ä¸²å˜é‡çš„å†…å®¹ã€‘ä½œä¸ºå±æ€§å



**å®ç°æ­¥éª¤ï¼š**



1. ä½¿ç”¨ `this.$router.push` å®ç°è·¯ç”±è·³è½¬
2. å°†å‚æ•°æ”¹æˆå¯¹è±¡æ–¹å¼ï¼Œæ–¹ä¾¿æºå¸¦å‚æ•°



**è½åœ°ä»£ç ï¼š**

```js
methods: {
  ...mapActions('home', ['getCategoryList']),
      
  toSearch(e) {
    // è·å–åˆ°ç‚¹å‡»åˆ†ç±»çš„ï¼šåˆ†ç±»çº§åˆ«ã€åˆ†ç±»ç¼–å·ã€åˆ†ç±»åç§°
    const { level, id } = e.target.dataset
    const { innerText } = e.target
    
    // åˆ¤æ–­ç‚¹å‡»çš„æ˜¯å¦ä¸ºåˆ†ç±»
    if (level) {
      this.$router.push({
        path: '/search',
        query: {
          [`category${level}Id`]: id,
          categoryName: innerText
        }
      })
    }
  }
},
```







## 6.  TypeNav å˜å…¨å±€ç»„ä»¶



**æ€è·¯åˆ†æï¼š**



`TypeNav` ç»„ä»¶éœ€è¦åœ¨å¤šä¸ªé¡µé¢ç»„ä»¶ä¸­è¿›è¡Œä½¿ç”¨ï¼Œä¸ºäº†æ–¹ä¾¿å¯¹ `TypeNav ` ç»„ä»¶è¿›è¡Œå¤ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å°† `TypeNav ` ç»„ä»¶æ³¨å†Œä¸ºäº†å…¨å±€ç»„ä»¶ï¼Œè¯­æ³•æ˜¯ï¼š

```js
Vue.component('ç»„ä»¶å', ç»„ä»¶)
```

 

**å®ç°æ­¥éª¤ï¼š**

1. å°†`TypeNav`ç»„ä»¶ï¼Œæ”¾å…¥`/src/components`ä¸­ã€‚

2. ç¬¬äºŒæ­¥ï¼š`src/main.js`ä¸­å¼•å…¥ï¼Œå¹¶å…¨å±€æ³¨å†Œ`TypeNav`ç»„ä»¶ã€‚

3. å»é™¤`src/views/Home/index.vue`ä¸­å¯¹`TypeNav`çš„å¼•å…¥ä¸æ³¨å†Œ

4. ç¬¬å››æ­¥ï¼šå»`Search`ã€`Home/index.vue` ç»„ä»¶ä¸­ï¼Œç›´ç¼–å†™`TypeNav`ç»„ä»¶æ ‡ç­¾å³å¯ã€‚

   

**è½åœ°ä»£ç ï¼š**

```js
// å¯¼å…¥ TypeNav ç»„ä»¶
import TypeNav from './components/TypeNav'

//å…¨å±€æ³¨å†Œ TypeNav ç»„ä»¶
Vue.component('TypeNav',TypeNav)

```







## 7. Search ä¸­çš„ TypeNav



**æ€è·¯åˆ†æï¼š**



ä¸šåŠ¡éœ€æ±‚ï¼š



1. éœ€æ±‚1ï¼šåœ¨`Search`ç»„ä»¶ä¸­ä½¿ç”¨`TypeNav`ç»„ä»¶
2. éœ€æ±‚2ï¼šåœ¨`Search`ç»„ä»¶ä¸­ä¸‰çº§åˆ†ç±»é»˜è®¤éšè—ï¼Œé¼ æ ‡ç§»å…¥æ—¶å±•ç¤ºï¼Œé¼ æ ‡ç§»å‡ºéšè—
3. éœ€æ±‚3ï¼šè‹¥æ‰€å¤„è·¯ç”±æ˜¯`/home`é‚£åˆ†ç±»å¯¼èˆªæ°¸ä¸æ¶ˆå¤±



**å®ç°æ­¥éª¤ï¼š**



1. `TypeNav`ç»„ä»¶ä¸­å®šä¹‰ `isShowNav` çŠ¶æ€ï¼Œæ§åˆ¶ä¸‰çº§åˆ†ç±»çš„å±•ç¤ºå’Œéšè—
2. ç»™æœ€å¤–ä¾§çš„ `<div class="nav-left">` åŠ ï¼šé¼ æ ‡ç§»å‡ºäº‹ä»¶ï¼Œæ§åˆ¶å…ƒç´ çš„éšè—
3. ç»™ `<h2 class="all">å…¨éƒ¨å•†å“åˆ†ç±»</h2>` åŠ ï¼šé¼ æ ‡ç§»å…¥äº‹ä»¶ï¼Œæ§åˆ¶å…ƒç´ çš„æ˜¾ç¤º
4. æ§åˆ¶å…ƒç´ çš„éšè—çš„äº‹ä»¶å¤„ç†å¤„ç†ç¨‹åºä¸­ï¼Œéœ€è¦åˆ¤æ–­æ˜¯å¦æ˜¯ `/home`ï¼Œå†³å®šæ˜¯å¦å±•ç¤ºä¸‰çº§åˆ†ç±»



**è½åœ°ä»£ç ï¼š**

1. `TypeNav`ç»„ä»¶ä¸­å®šä¹‰ `isShowNav` çŠ¶æ€ï¼Œæ§åˆ¶ä¸‰çº§åˆ†ç±»çš„å±•ç¤ºå’Œéšè—

   ```js
   data() {
     return {
       // isShowNav: false
       isShowNav: this.$route.path === '/home'
     }
   }
   ```

   

2. æ·»åŠ é¼ æ ‡ç§»å‡ºäº‹ä»¶å’Œé¼ æ ‡ç§»å…¥äº‹ä»¶ï¼Œæ§åˆ¶å…ƒç´ çš„éšè—å’Œæ˜¾ç¤º

   ```html
   <div class="nav-left" @mouseleave="executeHidden">
     <h2 class="all" @mouseenter="isShowNav = true">å…¨éƒ¨å•†å“åˆ†ç±»</h2>
     <!-- coding... -->
   </div>
   ```

   

3. æ§åˆ¶å…ƒç´ çš„éšè—çš„äº‹ä»¶å¤„ç†å¤„ç†ç¨‹åºä¸­ï¼Œéœ€è¦åˆ¤æ–­æ˜¯å¦æ˜¯ `/home`ï¼Œå†³å®šæ˜¯å¦å±•ç¤ºä¸‰çº§åˆ†ç±»

   ```js
   methods: {
     ...mapActions('home', ['getCategoryList']),
   
     // æ§åˆ¶å¯¼èˆªçš„éšè—å’Œå±•ç¤º
     executeHidden() {
       if (this.$route.path !== '/home') {
         this.isShowNav = false
       }
     },
   
     // coding...
   },
   ```

   





## 8. TypeNav æ·»åŠ åŠ¨ç”»



**æ€è·¯åˆ†æï¼š**



ä½¿ç”¨ `Vue` æä¾›çš„åŠ¨ç”»æ ‡ç­¾ç»“åˆ `animate.css` è¿›è¡Œä½¿ç”¨



**å®ç°æ­¥éª¤ï¼š**



1. ä¸‹è½½å¹¶å¼•å…¥ `animate.css` åŠ¨ç”»åº“
2. ç»™éœ€è¦åŠ¨ç”»çš„å…ƒç´ ï¼ŒåŒ…è£¹ `transition` ç»„ä»¶
3. ç»™ `transition` ç»„ä»¶æ·»åŠ åŠ¨ç”»æ ‡ç­¾



**è½åœ°ä»£ç ï¼š**



1. ä¸‹è½½å¹¶å¼•å…¥ `animate.css` åŠ¨ç”»åº“

   ```shell
   npm i animate.css
   ```

   

2. ç»™éœ€è¦åŠ¨ç”»çš„å…ƒç´ ï¼ŒåŒ…è£¹ `transition` ç»„ä»¶ï¼Œç»™ `transition` ç»„ä»¶æ·»åŠ åŠ¨ç”»æ ‡ç­¾

   ```vue
   <transition	
   	enter-active-class="animate__fadeIn"	
   	leave-active-class="animate__fadeOut"
   >	
     <div class="sort animate__animated" v-show="isShowNav">
       <!------------>
     </div>
   </transition>
   
   <script>	
     import 'animate.css'
      
     // coding...
   </script>	
   
   <style>    
     .sort {        
       /* coding... */
         
       --animate-duration: 0.5s;    
     }
   </style>
   ```

   





## 9. æºå¸¦å…³é”®å­—åˆ° Search



**æ€è·¯åˆ†æï¼š**



åœ¨è¾“å…¥æ¡†è¾“å…¥å…³é”®å­—ï¼Œç‚¹å‡»æœç´¢éœ€è¦è·³è½¬åˆ°æœç´¢é¡µé¢ï¼Œå®ç°è¿™ä¸ªåŠŸèƒ½çš„æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š

1. ä½¿ç”¨ `v-model` åŒå‘æ•°æ®ç»‘å®š
2. ä½¿ç”¨ `ref` è·å– `innerText `



åœ¨è¿™ä¸ªåŠŸèƒ½ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ `v-model` åŒå‘æ•°æ®ç»‘å®š



**å®ç°æ­¥éª¤ï¼š**



1. åœ¨ `data` ä¸­å®šä¹‰ `keyword` å…³é”®å­—ï¼Œä½¿ç”¨ `v-model` å’Œ `input` è¾“å…¥æ¡†è¿›è¡Œç»‘å®š
2. ç‚¹å‡»è¾“å…¥æ¡†ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦è¾“å…¥å†…å®¹ï¼Œå¦‚æœæ²¡æœ‰è¾“å…¥å†…å®¹ï¼Œè·¯ç”±è·³è½¬ï¼Œä¸æ‡ˆæ€ å‚æ•°



**è½åœ°ä»£ç ï¼š**

```vue
<input
  type="text"
  id="autocomplete"
  class="input-error input-xxlarge"
  v-model.trim="keyword"
/>
```

```vue
<script>
export default {
  name: 'HeaderIndex',
  data() {
    return {
      keyword: '' // ç”¨æˆ·è¾“å…¥çš„å…³é”®å­—
    }
  },
  methods: {
    toSearch() {
      this.$router.push({
        path: '/search',
        query: {
          keyword: this.keyword || undefined
        }
      })
    },
    toTest() {
      this.$router.push('/test')
    }
  }
}
</script>
```







## 10. åˆå¹¶æœç´¢å‚æ•°



**æ€è·¯åˆ†æï¼š**



æœç´¢çš„å…³é”®è¯ å’Œ åˆ†ç±»åï¼Œéœ€è¦è¿›è¡Œåˆå¹¶ï¼Œä¾‹å¦‚ï¼šç‚¹å‡»ã€æ‰‹æœºåˆ†ç±»ã€‘ï¼Œéšåå†æœç´¢ã€å°ç±³ã€‘ï¼Œæœ€ç»ˆæ˜¯ä¸€ä¸ªç»„åˆçš„æ¡ä»¶ï¼šã€æ‰‹æœºåˆ†ç±»+å°ç±³ã€‘



å› æ­¤éœ€è¦å°† `Header`ç»„ä»¶ã€`TypeNav`ç»„ä»¶ä¸­çš„ `toSearch` æ–¹æ³•éƒ½è¦æ”¹ä¸€ä¸‹ã€‚



æ€è€ƒï¼šå¦‚ä½•å¿«é€Ÿå°†å¤šä¸ªå¯¹è±¡ï¼Œåˆå¹¶æˆä¸€ä¸ªå¯¹è±¡ â“

å›ç­”ï¼šå±•å¼€è¿ç®—ç¬¦



**å®ç°æ­¥éª¤ï¼š**



1. `TypeNav`ç»„ä»¶ä¸­ï¼Œéœ€è¦è·å– `keyword` å…³é”®å­—
2. `Header`ç»„ä»¶ä¸­ï¼Œéœ€è¦è·å– `åˆ†ç±»çš„åå­—` å’Œ `åˆ†ç±»çš„ Id` åæ‹¼æ¥



**è½åœ°ä»£ç ï¼š**



1. `TypeNav`ç»„ä»¶

   ```js
   methods: {
     // åˆ°æœç´¢é¡µé¢
     toSearch(e) {
       // è·å–åˆ°ç‚¹å‡»åˆ†ç±»çš„ï¼šåˆ†ç±»çº§åˆ«ã€åˆ†ç±»ç¼–å·ã€åˆ†ç±»åç§°
       const { level, id } = e.target.dataset
       const { innerText } = e.target
       const { keyword } = this.$route.query
       // åˆ¤æ–­ç‚¹å‡»çš„æ˜¯å¦ä¸ºåˆ†ç±»
       if (level) {
         this.$router.push({
           path: '/search',
           query: {
             keyword,
             [`category${level}Id`]: id,
             categoryName: innerText
           }
         })
       }
     }
   }
   ```

   

2. `Header`ç»„ä»¶

   ```js
   methods: {
     toSearch() {
       const { query } = this.$route
   
       this.$router.push({
         path: '/search',
         query: {
           ...query,
           keyword: this.keyword || undefined
         }
       })
     }
   }
   ```

   













 