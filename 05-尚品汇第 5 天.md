#  å°šå“æ±‡ç¬¬ 5 å¤©





## 1. é¢åŒ…å±‘-æ¥æ”¶å“ç‰Œå



**æ€è·¯åˆ†æï¼š**

<img src="./images/5-1 å“ç‰Œå.png" style="zoom:80%; border: 1px solid #ccc" />



å½“ç”¨æˆ·ç‚¹å‡»å“ç‰Œåçš„æ—¶å€™ï¼Œéœ€è¦å°†å“ç‰Œåå‘ˆç°åˆ°å…¨éƒ¨ç»“æœä½ç½®ï¼Œä¹‹å‰å®ç°çš„æ–¹å¼æ˜¯å°†æ•°æ®æ”¾åˆ° `URL` åœ°å€ä¸­ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥æ‹¼æ¥åˆ° `URL` åœ°å€ä¸­ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬å°†æ‰€æœ‰çš„å‚æ•°éƒ½æ”¾åˆ° `URL` åœ°å€ä¸­ï¼Œä¼šå¯¼è‡´åœ°å€å¾ˆé•¿ï¼Œåˆ†äº«çš„æ—¶å€™ä¼šé€ æˆä¸€äº› åº”ç”¨ è¯¯åˆ¤ä¸ºåƒåœ¾é“¾æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å»ºè®®ä¸è¦æ‹¼æ¥åˆ° `URL` åœ°å€ä¸­ï¼Œé‚£ä¹ˆæ€ä¹ˆå¤„ç†å‘¢ ï¼Ÿ



ç»è¿‡åˆ†æï¼Œå¯ä»¥çŸ¥é“ï¼š

1. `SearchSelector` ä¸ºå­ç»„ä»¶
2. `Search` ä¸ºçˆ¶ç»„ä»¶



å½“ç‚¹å‡»å­ç»„ä»¶ä¸­çš„å“ç‰Œæ—¶ï¼Œéœ€è¦å°†å€¼ä¼ é€’ç»™çˆ¶ç»„ä»¶ï¼Œæ¶‰åŠåˆ°å­å¾€çˆ¶ä¼ å€¼ï¼Œå› æ­¤å®ç°çš„æ–¹å¼æ˜¯ `$emit` è‡ªå®šä¹‰äº‹ä»¶



**å®ç°æ­¥éª¤ï¼š**



1. åœ¨`SearchSelector` å­ç»„ä»¶ä¸­é€šè¿‡ `$emit` è§¦å‘ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œå¹¶ä¼ é€’å‚æ•°
2. åœ¨`Search` ç»„ä»¶ä¸­é€šè¿‡ `v-on` ç›‘å¬ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œå¯¹åº”ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åº
3. åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼Œæ¥æ”¶åˆ°å‚æ•°ï¼Œå¹¶å°†å‚æ•°ä¼ é€’ç»™æœç´¢å‚æ•° `searchParams`





**è½åœ°ä»£ç ï¼š**



1. åœ¨`SearchSelector` å­ç»„ä»¶ä¸­é€šè¿‡ `$emit` è§¦å‘ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œå¹¶ä¼ é€’å‚æ•°

   ```html
   <!-- å“ç‰Œåˆ—è¡¨åŒº -->
   <ul class="logo-list">
     <!-- éå†ç”Ÿæˆå“ç‰Œåˆ—è¡¨ -->
     <li
       v-for="trademark in trademarkList"
       :key="trademark.tmId"
       @click="sendTrademark(trademark)"
      >
       {{ trademark.tmName }}
     </li>
   </ul>
   ```

   ```js
   methods: {
     // ç‚¹å‡»å“ç‰Œçš„å›è°ƒ
     sendTrademark(trademark) {
       this.$emit('get-trademark', trademark)
     }
   }
   ```

   

2. åœ¨`Search` ç»„ä»¶ä¸­é€šè¿‡ `v-on` ç›‘å¬ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œå¯¹åº”ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œæ¥æ”¶ä¼ é€’çš„å‚æ•°

   ```html
   <!-- æœç´¢å™¨ -->
   <!-- ç»™å­ç»„ä»¶ SearchSelector ç»‘å®šè‡ªå®šä¹‰äº‹ä»¶ï¼Œç”¨äºè·å–ç‚¹å‡»çš„å“ç‰Œä¿¡æ¯-->
   <SearchSelector @get-trademark="saveTrademark" />
   ```

   ```js
   methods: {
     // ç”¨äºæ¥æ”¶ SearchSelector å­ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å“ç‰Œæ•°æ®
     saveTrademark(trademark) {
       console.log('æˆ‘æ˜¯Searchç»„ä»¶ï¼Œæ”¶åˆ°äº†å„¿å­ç»™æˆ‘çš„å“ç‰Œï¼š', trademark)
     }
   }
   ```

   

   







## 2. é¢åŒ…å±‘-å±•ç¤ºå“ç‰Œå



**æ€è·¯åˆ†æï¼š**



<img src="./images/5-1 å“ç‰Œå.png" style="zoom:80%; border: 1px solid #ccc" />



åœ¨çˆ¶ç»„ä»¶ä¸­ï¼Œæ¥æ”¶åˆ°æ•°æ®åï¼Œéœ€è¦å°†æ•°æ®å±•ç¤ºåˆ°å…¨éƒ¨ç»“æœåŒºåŸŸï¼ŒåŒæ—¶éœ€è¦å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œè·å–æœ€æ–°çš„æœç´¢åŒºåŸŸæ•°æ®ï¼Œæ¸²æŸ“åˆ°é¡µé¢ä¸Š



éœ€è¦æ³¨æ„æ¥å£æ¥æ”¶çš„å“ç‰Œå‚æ•°æ ¼å¼ï¼š

| å‚æ•°åç§°  |  ç±»å‹  | æ˜¯å¦å¿…é€‰ |                  æè¿°                   |
| :-------: | :----: | :------: | :-------------------------------------: |
| trademark | string |    N     | å“ç‰Œ: "`ID:å“ç‰Œåç§°`"  ç¤ºä¾‹: "`1:è‹¹æœ`" |





**å®ç°æ­¥éª¤ï¼š**



1. ä»`searchParams`ä¸­å¾—åˆ°`trademark`ï¼Œå±•ç¤ºåˆ°é¡µé¢
2. ä½¿ç”¨`v-show`åšåˆ¤æ–­ï¼š `v-show="searchParams.trademark"` 
3. é€šè¿‡ `dispatch` è°ƒç”¨ `action` é‡æ–°å‘èµ·è¯·æ±‚
4. é€šè¿‡ `split` å¤„ç†å±•ç¤ºå‡ºæ¥çš„é¡µé¢æ•°æ®



**è½åœ°ä»£ç ï¼š**



1. ä»`searchParams`ä¸­å¾—åˆ°`trademark`ï¼Œå±•ç¤ºåˆ°é¡µé¢

2. ä½¿ç”¨`v-show`åšåˆ¤æ–­ï¼š `v-show="searchParams.trademark"` 

   ```html
   <!-- å“ç‰Œé¢åŒ…å±‘ -->
   <li class="with-x" v-show="searchParams.trademark">
     {{ searchParams.trademark }} <i @click="removeTrademark">Ã—</i>
   </li>
   ```

   

3. é€šè¿‡ `dispatch` è°ƒç”¨ `action` é‡æ–°å‘èµ·è¯·æ±‚

   ```js
   methods: {
     // é¢åŒ…å±‘-ç§»é™¤åˆ†ç±»å
     // coding......
   
     // é¢åŒ…å±‘-ç§»é™¤å…³é”®å­—
     // coding......
   
     // é¢åŒ…å±‘-ç§»é™¤å“ç‰Œå
     removeTrademark() {
       console.log('ç§»é™¤é¢åŒ…å±‘')
     },
   
     // ç”¨äºæ¥æ”¶ SearchSelector å­ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å“ç‰Œæ•°æ®
     saveTrademark(trademark) {
       // å¯¹ searchParams ä¸­çš„æ•°æ®è¿›è¡Œèµ‹å€¼
       this.searchParams.trademark = `${trademark.tmId}:${trademark.tmName}`
   
       // é‡æ–°æœç´¢
       this.$store.dispatch('search/getSearchInfo', this.searchParams)
     }
   }
   ```

   

4. å¤„ç†å±•ç¤ºå‡ºæ¥çš„é¡µé¢æ•°æ®

   ```html
   <!-- å“ç‰Œé¢åŒ…å±‘ -->
   <li class="with-x" v-show="searchParams.trademark">
     {{ searchParams.trademark.split(':')[1] }} <i @click="removeTrademark">Ã—</i>
   </li>
   ```

   







## 3. é¢åŒ…å±‘-ç§»é™¤å“ç‰Œå



**æ€è·¯åˆ†æï¼š**



å½“ç”¨æˆ·ç‚¹å‡»åˆ é™¤å“ç‰Œçš„æ—¶å€™ï¼Œåº”è¯¥å°†å…³é”®å­—ç§»é™¤ï¼Œéœ€è¦åšä»¥ä¸‹å¤„ç†



1. å°†å“ç‰Œé‡ç½®ä¸ºç©º
2. é‡æ–°å‘èµ·ç½‘ç»œè¯·æ±‚



**å®ç°æ­¥éª¤ï¼š**



1. ç»™å“ç‰ŒæŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶
2. åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­ç§»é™¤å‚æ•°å’Œé‡æ–°æœç´¢



**è½åœ°ä»£ç ï¼š**

```js
methods: {
  // é¢åŒ…å±‘-ç§»é™¤å“ç‰Œå
  removeTrademark() {
    // ç§»é™¤å‚æ•°
    this.searchParams.trademark = ''

    // é‡æ–°æœç´¢
    this.$store.dispatch('search/getSearchInfo', this.searchParams)
  }
}
```









## 4. é¢åŒ…å±‘-æ¥æ”¶å±æ€§å



**æ€è·¯åˆ†æï¼š**

<img src="./images/5-2 å±•ç¤ºå±æ€§.png" style="zoom:80%; border: 1px solid #ccc" />



å½“ç”¨æˆ·ç‚¹å‡»å±æ€§æ—¶ï¼Œéœ€è¦å°†å±æ€§å±•ç¤ºåˆ°å…¨éƒ¨ç»“æœä½ç½®ï¼Œç»è¿‡åˆ†æï¼Œå¯ä»¥çŸ¥é“ï¼š

1. `SearchSelector` ä¸ºå­ç»„ä»¶
2. `Search` ä¸ºçˆ¶ç»„ä»¶



å½“ç‚¹å‡»å­ç»„ä»¶ä¸­çš„å“ç‰Œæ—¶ï¼Œéœ€è¦å°†å€¼ä¼ é€’ç»™çˆ¶ç»„ä»¶ï¼Œæ¶‰åŠåˆ°å­å¾€çˆ¶ä¼ å€¼ï¼Œå› æ­¤å®ç°çš„æ–¹å¼æ˜¯ `$emit` è‡ªå®šä¹‰äº‹ä»¶ï¼Œåªä¸è¿‡æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ï¼š`éœ€è¦å°†å“ªäº›æ•°æ®ä¼ é€’ç»™çˆ¶ç»„ä»¶`ï¼ŒæŸ¥é˜…æ¥å£æ–‡æ¡£å¾—çŸ¥ï¼Œéœ€è¦ä¼ é€’ä»¥ä¸‹æ•°æ®ï¼š

| å‚æ•°åç§° | ç±»å‹  | æ˜¯å¦å¿…é€‰ |                             æè¿°                             |
| :------: | :---: | :------: | :----------------------------------------------------------: |
|  props   | Array |    N     | å•†å“å±æ€§çš„æ•°ç»„: ["`å±æ€§ID`:`å±æ€§å€¼`:`å±æ€§å`"]  <br />                 ç¤ºä¾‹: ["2:6.0ï½6.24è‹±å¯¸:å±å¹•å°ºå¯¸"] |



**å®ç°æ­¥éª¤ï¼š**



1. åœ¨`SearchSelector` å­ç»„ä»¶ä¸­é€šè¿‡ `$emit` è§¦å‘ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œå¹¶ä¼ é€’å‚æ•°
2. åœ¨`Search` ç»„ä»¶ä¸­é€šè¿‡ `v-on` ç›‘å¬ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œå¯¹åº”ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åº
3. åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼Œæ¥æ”¶åˆ°å‚æ•°



**è½åœ°ä»£ç ï¼š**



1. åœ¨`SearchSelector` å­ç»„ä»¶ä¸­é€šè¿‡ `$emit` è§¦å‘ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œå¹¶ä¼ é€’å‚æ•°

   ```html
   <ul class="type-list">
     <!-- éå†å±æ€§å€¼ï¼ˆé»„è‰²ã€ç»¿è‰²ã€æ©™è‰²ã€200gã€215gã€6.5å¯¸ã€7.0å¯¸ï¼‰ -->
     <li v-for="(attrValue, index) in attrs.attrValueList" :key="index">
       <a @click="handleClickAttrValue(attrs, attrValue)">{{ attrValue }}</a>
     </li>
   </ul>
   ```

   ```js
   methods: {
     handleClickAttrValue(attrs, attrValue) {
       this.$emit('get-attr', attrs, attrValue)
     }
   }
   ```

   

2. åœ¨`Search` ç»„ä»¶ä¸­é€šè¿‡ `v-on` ç›‘å¬ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œå¯¹åº”ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åº

   ```vue
   <SearchSelector @get-trademark="saveTrademark" @get-attr="saveAttr" />
   ```

   

3. åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼Œæ¥æ”¶åˆ°å‚æ•°

   ```js
   methods: {
     // coding......
     
     // ç”¨äºæ¥æ”¶ SearchSelector å­ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å±æ€§æ•°æ®
     saveAttr(attrs, attrValue) {
       console.log('æˆ‘æ˜¯Searchç»„ä»¶ï¼Œæ”¶åˆ°äº†å±æ€§ä¿¡æ¯', attrs, attrValue)
     }
   },
   ```







## 5. é¢åŒ…å±‘-å±•ç¤ºå±æ€§å



**æ€è·¯åˆ†æï¼š**



| å‚æ•°åç§° | ç±»å‹  | æ˜¯å¦å¿…é€‰ |                             æè¿°                             |
| :------: | :---: | :------: | :----------------------------------------------------------: |
|  props   | Array |    N     | å•†å“å±æ€§çš„æ•°ç»„: ["`å±æ€§ID`:`å±æ€§å€¼`:`å±æ€§å`"]  <br />                 ç¤ºä¾‹: ["2:6.0ï½6.24è‹±å¯¸:å±å¹•å°ºå¯¸"] |



æ ¹æ®æ¥å£æ–‡æ¡£çš„è¦æ±‚ï¼Œéœ€è¦å°†å±æ€§åå¤„ç†æˆæ•°ç»„å½¢å¼ï¼Œå¹¶ä¸”æ¯ä¸€é¡¹ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œæ ¼å¼ä¸ºï¼š

```text
['å±æ€§ID:å±æ€§å€¼:å±æ€§å', 'å±æ€§ID:å±æ€§å€¼:å±æ€§å']

// ä¾‹å¦‚ï¼š

['2:æœºèº«å†…å­˜:512G', '3:è¿è¡Œå†…å­˜:12G']
```



ä½†æ˜¯é¡µé¢å±•ç¤ºçš„æ—¶å€™ï¼Œåªéœ€è¦å±•ç¤º å±æ€§å€¼:å±æ€§å å³å¯ï¼Œå¦‚ä¸‹å›¾ï¼š

<img src="./images/5-3 å±æ€§å±•ç¤º.png" style="zoom:80%; border: 1px solid #ccc" />



å› æ­¤å±•ç¤ºå±æ€§åçš„æ—¶å€™ï¼Œéœ€è¦å¯¹æ•°æ®ä½¿ç”¨ `split` å¤„ç†





**å®ç°æ­¥éª¤ï¼š**



1. æ¥æ”¶ä¼ é€’è¿‡æ¥çš„æ•°æ®ï¼ŒæŒ‰ç…§æ¥å£æ–‡æ¡£æ ¼å¼åŒ–æ•°æ®ï¼Œç„¶åå°†æ•°æ® `push` åˆ° `prop` å­—æ®µä¸­
2. é‡æ–°è¯·æ±‚æ•°æ®
3. åœ¨é¡µé¢ä¸­é€šè¿‡ `v-for` éå† `prop` ä¸­çš„æ•°æ®



**è½åœ°ä»£ç ï¼š**

1. æ¥æ”¶ä¼ é€’è¿‡æ¥çš„æ•°æ®ï¼ŒæŒ‰ç…§æ¥å£æ–‡æ¡£æ ¼å¼åŒ–æ•°æ®ï¼Œç„¶åå°†æ•°æ® `push` åˆ° `prop` å­—æ®µä¸­

2. é‡æ–°è¯·æ±‚æ•°æ®

   ```js
   methods: {
     // coding......
     
     // ç”¨äºæ¥æ”¶ SearchSelector å­ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å±æ€§æ•°æ®
     saveAttr(attrs, attrValue) {
       // æ‹¼æ¥åˆæ³•çš„å±æ€§åï¼Œæ ¼å¼ä¸ºï¼š['å±æ€§ID:å±æ€§å€¼:å±æ€§å', 'å±æ€§ID:å±æ€§å€¼:å±æ€§å']
       const attr = `${attrs.attrId}:${attrValue}:${attrs.attrName}`
       
       // å°†æ‹¼æ¥å‡ºæ¥çš„å±æ€§ä¿¡æ¯ï¼Œæ”¾åˆ° searchParams ä¸­
       this.searchParams.props.push(attr)
       
       // é‡æ–°å‘èµ·ç½‘ç»œè¯·æ±‚
       this.$store.dispatch('search/getSearchInfo', this.searchParams)
     }
   }
   ```

   

3. åœ¨é¡µé¢ä¸­é€šè¿‡ `v-for` éå† `prop` ä¸­çš„æ•°æ®

   ```html
   <!-- å±æ€§é¢åŒ…å±‘ -->
   <li class="with-x" v-for="(attr, index) in searchParams.props" :key="index">
     {{ attr.split(':')[2] + ' : ' + attr.split(':')[1] }} <i @click="removeProps">Ã—</i>
   </li>
   ```







## 6. é¢åŒ…å±‘-å±æ€§åå»é‡



**æ€è·¯åˆ†æï¼š**



<img src="./images/5-4 å±æ€§å±•ç¤º.png" style="zoom:80%; border: 1px solid #ccc" />



ç‚¹å‡»é€‰æ‹©å±æ€§åï¼Œå±æ€§åä¼šä¸€ç›´è¿½åŠ ï¼Œè¿™æ—¶å€™éœ€è¦è¿›è¡Œå»é‡å¤„ç†ï¼Œå¤„ç†çš„æ–¹å¼éå¸¸å¤šï¼Œå¯ä»¥æ ¹æ®è¿”å›å€¼æ¥è¿›è¡Œåˆ¤æ–­å¤„ç†ï¼Œä¾‹å¦‚ï¼š

```js
let arr = [1, 3, 5, 7, 9]

const x1 = arr.includes(9) // trueï¼Œæ²¡æœ‰è¿”å› false
const x2 = arr.indexOf(10) // 4 (ç´¢å¼•)ï¼Œæ²¡æœ‰è¿”å› -1
const x3 = arr.filter(item => item === 9) // [9] æ•°ç»„ï¼Œæ²¡æœ‰è¿”å› []
const x4 = arr.find(item => item === 9) // 9 è¿”å›æœ¬èº«ï¼Œæ²¡æœ‰ undefined
const x5 = arr.findIndex(item => item === 10) // 4 (ç´¢å¼•)ï¼Œæ²¡æœ‰è¿”å› -1
```



`ES6` ä¹Ÿç»™æä¾›äº† `Set` æ„é€ å‡½æ•°ç”¨æ¥è¿›è¡Œæ•°ç»„çš„å»é‡





**å®ç°æ­¥éª¤ï¼š**

**è½åœ°ä»£ç ï¼š**

```js
methods: {
  // coding......
  
  // ç”¨äºæ¥æ”¶ SearchSelector å­ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å±æ€§æ•°æ®
  saveAttr(attrs, attrValue) {
    // console.log('æˆ‘æ˜¯Searchç»„ä»¶ï¼Œæ”¶åˆ°äº†å±æ€§ä¿¡æ¯', attrs, attrValue)
    // æ‹¼æ¥åˆæ³•çš„å±æ€§åï¼Œæ ¼å¼ä¸ºï¼š['å±æ€§ID:å±æ€§å€¼:å±æ€§å', 'å±æ€§ID:å±æ€§å€¼:å±æ€§å']
    const attr = `${attrs.attrId}:${attrValue}:${attrs.attrName}`

    // ---------- æ–¹å¼1ï¼šä½¿ç”¨ includes è¿›è¡Œå»é‡ ----------
    
    // åˆ¤æ–­å±æ€§æ˜¯å¦é‡å¤
    const result = this.searchParams.props.includes(attr)

    if (!result) {
      // å°†æ‹¼æ¥å‡ºæ¥çš„å±æ€§ä¿¡æ¯ï¼Œæ”¾åˆ° searchParams ä¸­
      this.searchParams.props.push(attr)
      // é‡æ–°å‘èµ·ç½‘ç»œè¯·æ±‚
      this.$store.dispatch('search/getSearchInfo', this.searchParams)
    }

    // ---------- æ–¹å¼2ï¼šä½¿ç”¨ new Set æ„é€ å‡½æ•°è¿›è¡Œå»é‡ ----------
    
    // å°†æ‹¼æ¥å‡ºæ¥çš„å±æ€§ä¿¡æ¯ï¼Œæ”¾åˆ° searchParams ä¸­
    // this.searchParams.props.push(attr)
      
    // ä½¿ç”¨ new Set() è¿›è¡Œå»é‡
    // this.searchParams.props = [...new Set(this.searchParams.props)]

    // é‡æ–°å‘èµ·ç½‘ç»œè¯·æ±‚
    // this.$store.dispatch('search/getSearchInfo', this.searchParams)
  }
}
```









## 7. é¢åŒ…å±‘-ç§»é™¤å±æ€§å



**æ€è·¯åˆ†æï¼š**



å½“ç”¨æˆ·ç‚¹å‡»åˆ é™¤å±æ€§åçš„æ—¶å€™ï¼Œåº”è¯¥å°†å±æ€§åç§»é™¤ï¼Œéœ€è¦åšä»¥ä¸‹å¤„ç†



1. å°†å±æ€§åä» `props` æ•°ç»„ä¸­ç§»é™¤
2. é‡æ–°å‘èµ·ç½‘ç»œè¯·æ±‚



**å®ç°æ­¥éª¤ï¼š**



1. ç»™å±æ€§åæŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶
2. åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­å°†å±æ€§åä» `props` æ•°ç»„ä¸­ç§»é™¤å’Œé‡æ–°æœç´¢



**è½åœ°ä»£ç ï¼š**



1. ç»™å±æ€§åæŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶

   ```vue
   <!-- å±æ€§é¢åŒ…å±‘ -->
   <li class="with-x" v-for="(attr, index) in searchParams.props" :key="index">
     {{ attr.split(':')[2] + ' : ' + attr.split(':')[1] }} 
     <i @click="removeProps(index)">Ã—</i>
   </li>
   ```

   

2. åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­å°†å±æ€§åä» `props` æ•°ç»„ä¸­ç§»é™¤å’Œé‡æ–°æœç´¢

   ```js
   methods: {
     // coding......
     
     // é¢åŒ…å±‘-æ¸…é™¤å±æ€§å
     removeProps(index) {
       this.searchParams.props.splice(index, 1)
   
       // é‡æ–°å‘èµ·ç½‘ç»œè¯·æ±‚
       this.$store.dispatch('search/getSearchInfo', this.searchParams)
     }
   }
   ```







## 8. é¢åŒ…å±‘-å°ç»†èŠ‚å®Œå–„(1)



**æ€è·¯åˆ†æï¼š**



ç›®å‰åœ¨æ¨¡æ¿ä¸­æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦è¿›è¡Œä¼˜åŒ–ï¼Œå¦‚ä¸‹ä¸¤ä¸ªä»£ç ç‰‡æ®µï¼š

```html
<!-- å±æ€§é¢åŒ…å±‘ -->
<li class="with-x" v-for="(attr, index) in searchParams.props" :key="index">
  {{ attr.split(':')[2] + ' : ' + attr.split(':')[1] }} <i @click="removeProps(index)">Ã—</i>
</li>
```

```html
<!-- å“ç‰Œé¢åŒ…å±‘ -->
<li class="with-x" v-show="searchParams.trademark">
  {{ searchParams.trademark.split(':')[1] }} <i @click="removeTrademark">Ã—</i>
</li>
```



ä¼šå‘ç°ï¼Œæˆ‘ä»¬åœ¨æ’å€¼è¡¨è¾¾å¼ä¸­å†™äº†å¤§é‡çš„é€»è¾‘ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ­¤è¿›è¡Œä¼˜åŒ–ï¼Œæœ‰å“ªå‡ ç§ä¼˜åŒ–çš„æ–¹å¼å‘¢ï¼Ÿ

1. è®¡ç®—å±æ€§
2. æ–¹æ³•
3. filter



**å®ç°æ­¥éª¤ï¼š**



1. `å“ç‰Œé¢åŒ…å±‘ ` ä½¿ç”¨ `è®¡ç®—å±æ€§`
2. `å±æ€§é¢åŒ…å±‘` ä½¿ç”¨ `methods æ–¹æ³•`



**è½åœ°ä»£ç ï¼š**

```js
computed: {
  trademarkName() {
    return this.searchParams.trademark.split(':')[1]
  }
}
```

```js
methods: {
  // coding......
  
  // ä¸“é—¨ç”¨äºæ ¼å¼åŒ–æ¯ä¸ªå•†å“å±æ€§çš„æ–¹æ³•
  attrShowName(attr) {
    return attr.split(':')[2] + ':' + attr.split(':')[1]
  }
}
```









## 9. é¢åŒ…å±‘-å°ç»†èŠ‚å®Œå–„(2)



**æ€è·¯åˆ†æï¼š**



`this.$store.dispatch('search/getSearchInfo', this.searchParams)` è§¦å‘ `actions` é‡æ–°å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œè¿™å¥è¯è¦ç»å¸¸æ‰§è¡Œï¼Œä¸”`searchParams`ä¸€å˜åŒ–å°±è¦æ‰§è¡Œï¼Œå› æ­¤éœ€è¦è¿›è¡Œä¼˜åŒ–ï¼Œå¦‚ä½•ä¼˜åŒ–ï¼š



`watch` ä¾¦å¬å™¨ï¼Œä½¿ç”¨ `watch` ä¾¦å¬å™¨ å¯¹ `searchParams` è¿›è¡Œæ·±åº¦ç›‘å¬



**å®ç°æ­¥éª¤ï¼š**



1. åˆ æ‰æ¯ä¸ªæ–¹æ³•é‡Œçš„ `this.$store.dispatch('search/getSearchInfo', this.searchParams)`
2. åœ¨`watch`ä¸­ç›‘è§†`searchParams`ï¼Œå›è°ƒä¸­è¿›è¡Œ`dispatch`



**è½åœ°ä»£ç ï¼š**

```js
watch: {
  // ç›‘è§†searchParamsï¼Œåªè¦searchParamså˜åŒ–ï¼Œç›´æ¥æ‹¿ç€å®ƒå‘è¯·æ±‚ã€‚
  searchParams: {
    handler() {
      // æ‹¿ç€searchParamsï¼Œå‘è¯·æ±‚è·æœç´¢æ•°æ®ï¼Œå¹¶å­˜å…¥vuex
      this.$store.dispatch('getSearchInfo', this.searchParams)
    },
    deep: true,
    immediate: true
  }
}
```







## 10. åˆ†é¡µ-å¯¹åˆ†é¡µçš„ç†è§£



**æ€è·¯åˆ†æï¼š**



åœ¨ç½‘é¡µä¸Šæµè§ˆå†…å®¹æ—¶ï¼Œå¦‚æœæœç´¢çš„å†…å®¹æ•°æ®æ¯”è¾ƒå¤§ï¼Œåœ¨è¯¥é¡µé¢çš„åº•éƒ¨ï¼Œé€šå¸¸éƒ½ä¼šæœ‰ä¸ªåˆ†é¡µï¼Œé€šè¿‡ç¿»é¡µç­‰æ“ä½œï¼Œè·³è½¬åˆ°å…¶ä»–é¡µé¢æŸ¥çœ‹æ–°çš„å†…å®¹ã€‚

<img src="./images/5-5 åˆ†é¡µ.png" style="zoom:80%; border: 1px solid #ccc" />



å½“æœ‰å¤§é‡ä¿¡æ¯éœ€è¦å±•ç¤ºç»™ç”¨æˆ·æ—¶ï¼Œä¸ºäº†é™ä½å•æ¬¡è¯·æ±‚å¯¹æœåŠ¡å™¨äº§ç”Ÿçš„æ€§èƒ½å‹åŠ›å’Œæ—¶é—´æŸè€—ï¼Œæ¯æ¬¡åªåŠ è½½å›ºå®šæ•°é‡çš„å°‘é‡ä¿¡æ¯ã€‚ç”¨æˆ·æµè§ˆå®Œä¹‹åï¼Œé€šè¿‡æ“ä½œåˆ†é¡µåŠŸèƒ½ï¼Œå†å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œä»¥è·å–æ›´å¤šå†…å®¹ã€‚



**åˆ†é¡µä½œç”¨ï¼š**



è¯´åˆ°åº•ï¼Œåˆ†é¡µä¸»è¦è§£å†³äº† 2 ä¸ªé—®é¢˜ï¼š



1. å‡å°‘äº†å•æ¬¡è¯·æ±‚å¯¹æœåŠ¡å™¨äº§ç”Ÿçš„æ€§èƒ½å‹åŠ›å’Œç­‰å¾…æ—¶é—´

   - å‡å¦‚æˆ‘ä»¬é€›æ·˜å®ï¼Œå½“æœ‰æˆåƒä¸Šä¸‡ä¸ªå•†å“è¦å±•ç¤ºç»™ç”¨æˆ·
   - è‹¥ä¸åšåˆ†é¡µï¼ŒæœåŠ¡ç«¯å°±éœ€è¦å°†è¿™ä¹ˆåºå¤§çš„æ•°æ®é‡ä¸€æ¬¡æ€§ä¼ é€’ç»™å‰ç«¯
   - ä¼šé€ æˆæœåŠ¡å™¨å‹åŠ›å¤§ï¼Œç”¨æˆ·ç­‰å¾…æ•°æ®åŠ è½½çš„æ—¶é—´ä¹Ÿä¼šæ›´é•¿

   

2. åˆ†é¡µåŠŸèƒ½å‡å°‘äº†ä½ä»·å€¼è¯·æ±‚

   - å‡å¦‚æˆ‘ä»¬é€›æ·˜å®ï¼Œæ¯é¡µæœ‰ 100 ä¸ªå•†å“ï¼Œæ€»å…±99 é¡µï¼Œä¸€å…± 9900 ä¸ªå•†å“
   - è‹¥ä¸åšåˆ†é¡µåŠŸèƒ½ï¼Œç”¨æˆ·çš„ä¸€æ¬¡æœç´¢è¯·æ±‚ï¼Œå°±éœ€è¦ä¸€æ¬¡å°† 9900 ä¸ªå•†å“åŒ…å«å›¾ç‰‡å…¨éƒ¨åŠ è½½å‡ºæ¥
   - ä½†å®é™…æƒ…å†µæ˜¯ï¼Œç”¨æˆ·ä¸ä¼šæŠŠ 4560ä¸ªå•†å“çœ‹å®Œï¼Œä¸€èˆ¬åªçœ‹äº†å‰ å‡ é¡µå°±ç¡®å®šäº†è´­ä¹°æ„å‘
   - é‚£è¿™æ—¶åé¢å…¶ä»–é¡µçš„å†…å®¹å°±æ˜¯ç™½åŠ è½½äº†ï¼Œè¿™å…¶å®å°±æ˜¯æ— ä»·å€¼çš„åŠ è½½è¯·æ±‚





**åˆ†é¡µç»„æˆåŠå…¶åŠŸèƒ½**



<img src="./images/5-6 åˆ†é¡µ.png" style="zoom:80%; border: 1px solid #ccc" />



1. **<font color="red">æ•°æ®æ€»æ¡é‡</font>**ï¼šæ€»å…±æœ‰å¤šå°‘æ¡æ•°æ® ï¼ˆ`total`ï¼‰
3. **<font color="red">é¡µé¢å±•ç¤ºæ•°é‡</font>**ï¼šæ¯ä¸ªé¡µé¢å±•ç¤ºå¤šå°‘æ•°æ® ï¼ˆ`pageNum`ï¼‰
4. **<font color="red">å½“å‰é¡µç </font>ï¼š**å½“å‰æ‰€å¤„çš„åˆ†é¡µä½ç½®ï¼Œç¬¬å‡ é¡µï¼ˆ`pageSize`ï¼‰
5. **<font color="red">ç›¸é‚»é¡µç å±•ç¤º</font>ï¼š**å½“å‰é¡µç çš„å‰åå‡ é¡µ ï¼ˆ`continues`ï¼‰
5. **<font color="green">æ€»é¡µæ•°</font>**ï¼šæ€»å…±æœ‰å¤šå°‘åˆ†é¡µï¼Œè®¡ç®—å…¬å¼ï¼š`æ•°æ®æ€»é‡ / é¡µé¢å±•ç¤ºæ•°é‡ `



> ğŸ“Œ Tipï¼š
>
> â€‹		çº¢è‰²æ˜¯å¿…é¡»ä¼ é¡¹ï¼Œç»¿è‰²çš„ä¸ç”¨ä¼ ï¼Œå¯ä»¥æ ¹æ®çº¢è‰²ç®—å‡ºæ¥ã€‚







## 11. åˆ†é¡µ-é™æ€ç»„ä»¶ç»˜åˆ¶



**æ€è·¯åˆ†æï¼š**



â€‹	ç›´æ¥ä½¿ç”¨æä¾›çš„ç»„ä»¶å³å¯ï¼Œåªä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼š`åˆ†é¡µç»„ä»¶æ˜¯ä¸€ä¸ªå…¨å±€ç»„ä»¶`



**å®ç°æ­¥éª¤ï¼š**



1. åœ¨ `components` ç›®å½•ä¸‹æ–°å»º `Pagination` ç»„ä»¶ 
2. ç»„ä»¶ä»£ç ç›´æ¥å¤åˆ¶ä¸‹æ–¹çš„ä»£ç å³å¯
3. å°†`Pagination` ç»„ä»¶ æ³¨å†Œä¸ºå…¨å±€ç»„ä»¶
4. åœ¨ `Search` ç»„ä»¶ä¸­ä½¿ç”¨ `Pagination` ç»„ä»¶



**è½åœ°ä»£ç ï¼š**



1. åˆ›å»ºï¼š`src\components\Pagination\index.vue`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

   ```vue
   <template>  
   	<div class="pagination">
       <button>ä¸Šä¸€é¡µ</button>
       <button>1</button>
       <span>Â·Â·Â·</span>
       
       <button>6</button>
       <button>7</button>
       <button class="active">8</button>    
       <button>9</button>
       <button>10</button>
       
       <span>Â·Â·Â·</span>
       <button>21</button>
       <button>ä¸‹ä¸€é¡µ</button>
       
       <span>å…± 103 æ¡</span>
     </div>
   </template>
   
   <script>    
     export default {      
       name: "Pagination",    
     };
   </script>
   
   <style lang="less" scoped>
     .pagination {
       text-align: center;
   
       button {
         margin: 0 5px;
         background-color: #f4f4f5;
         color: gray;
         outline: none;
         border-radius: 2px;
         padding: 0 4px;
         vertical-align: top;
         display: inline-block;
         font-size: 13px;
         min-width: 35.5px;
         height: 28px;
         line-height: 28px;
         cursor: pointer;
         box-sizing: border-box;
         text-align: center;
         border: 0;
   
         &[disabled] {
           color: #c0c4cc;
           cursor: not-allowed;
         }
   
         &.active {
           cursor: not-allowed;
           background-color: #c81623;
           color: #fff;
         }
       }
   
       span {
         display: inline-block;
         line-height: 28px;
         font-size: 14px;
         color: gray;
         vertical-align: middle;
       }
     }
   </style>
   ```

2. è®°å¾—å»`main.js`ä¸­å¼•å…¥å¹¶æ³¨å†Œ`Pagination`ç»„ä»¶ã€‚

   ```js
   import Pagination from './components/Pagination'
   //å…¨å±€æ³¨å†ŒPaginationç»„ä»¶
   Vue.component('Pagination',Pagination)
   ```

3. å»`Search`ç»„ä»¶æŒ‡å®šä½ç½®ï¼Œç›´æ¥ç¼–å†™ç»„ä»¶æ ‡ç­¾`<Pagination/>`

   ```html
   <!-- åˆ†é¡µå™¨ -->
   <div class="pagination">
     <Pagination />
   </div>
   ```





Â·

## 12.åˆ†é¡µ-è®¡ç®—æ€»é¡µæ•°



**æ€è·¯åˆ†æï¼š**



ä¸ºäº†ä¸€æ­¥æ­¥å®Œæˆåˆ†é¡µåŠŸèƒ½çš„å¼€å‘ï¼Œæˆ‘ä»¬å…ˆä¼ªé€ ä¸€äº›æ•°æ®ï¼Œè®¡ç®—å‡ºåˆ†é¡µæ€»é¡µé¢



**å®ç°æ­¥éª¤ï¼š**



1. é€šè¿‡`Pagination`ç»„ä»¶æ ‡ç­¾ä¸­ä¼ é€’ä¸€äº›æ¨¡æ‹Ÿæ•°æ®
2. åœ¨`Pagination`ç»„ä»¶å†…é€šè¿‡ `props` æ¥æ”¶ä¸€äº›æ¨¡æ‹Ÿæ•°æ®



**è½åœ°ä»£ç ï¼š**



1. é€šè¿‡`Pagination`ç»„ä»¶æ ‡ç­¾ä¸­ä¼ é€’ä¸€äº›æ¨¡æ‹Ÿæ•°æ®

   ```html
   <!-- åˆ†é¡µå™¨ -->
   <Pagination :total="103" :pageSize="5" :pageNo="16" :continues="5"/>
   ```

   

2. åœ¨`Pagination`ç»„ä»¶å†…é€šè¿‡ `props` æ¥æ”¶ä¸€äº›æ¨¡æ‹Ÿæ•°æ®

   ```vue
   <template>
     <div class="pagination">
       <button>ä¸Šä¸€é¡µ</button>
       <button>1</button>
       <span>Â·Â·Â·</span>
   
       <button>6</button>
       <button>7</button>
       <button class="active">8</button>
       <button>9</button>
       <button>10</button>
   
       <span>Â·Â·Â·</span>
       <button>{{ totalPage }}</button>
       <button>ä¸‹ä¸€é¡µ</button>
   
       <span>å…± {{ total }} æ¡</span>
     </div>
   </template>
   
   <script>
   export default {
     name: 'SphPagination',
     props: {
       // æ•°æ®æ€»æ¡é‡
       total: {
         type: Number,
         require: true,
         default: 0
       },
       // é¡µé¢å±•ç¤ºæ•°é‡
       pageSize: {
         type: Number,
         require: true,
         default: 10
       },
       // å½“å‰é¡µç 
       pageNum: {
         type: Number,
         require: true,
         default: 1
       },
       // ç›¸é‚»é¡µç å±•ç¤ºæ•°
       continues: {
         type: Number,
         require: true,
         default: 5
       }
     },
     computed: {
       totalPage() {
         return Math.ceil(this.total / this.pageSize)
       }
     }
   }
   </script>
   ```



 





## 13.åˆ†é¡µ-ç®—è¿ç»­é¡µæ•°-æ ‡å‡†æƒ…å†µ



**æ€è·¯åˆ†æï¼š**



```shell
ä¾‹å¦‚ï¼š

total = 103
pageSize = 10
pageNum = 7
continues = 5

ã€å½“å‰é¡µç ã€‘ ç­‰äº ã€7ã€‘
ã€ç›¸é‚»é¡µç ã€‘ ç­‰äº ã€5ã€‘

æ‰€ä»¥ç›¸é‚»é¡µç åŒºåŸŸåº”è¯¥å±•ç¤º  5 6 7 8 9
```



éœ€è¦æ ¹æ®ä¼ å…¥çš„ä¼ªæ•°æ®ï¼Œè®¡ç®—å‡ºè¿ç»­çš„é¡µæ•°æ˜¯å“ªå‡ ä¸ªé¡µé¢ï¼Œæˆ‘ä»¬ç›®å‰å¸Œæœ› ç›¸é‚»é¡µç å±•ç¤º æ˜¯ 5ï¼Œé‚£ä¹ˆå½“å‰é¡µä¸¤ä¾§å·¦å³åº”è¯¥ä¸º 2 ï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š



```text
èµ·å§‹é¡µï¼šå½“å‰é¡µç  - (è¿ç»­é¡µæ•° - 1) / 2

ç»“æŸé¡µï¼šå½“å‰é¡µç  + (è¿ç»­é¡µæ•° - 1) / 2
```



**å®ç°æ­¥éª¤ï¼š**



1. åœ¨è®¡ç®—å±æ€§ä¸­ï¼Œåˆ©ç”¨åˆ†æå‡ºæ¥çš„å…¬å¼ï¼Œå¾—å‡ºæ ‡å‡†æƒ…å†µä¸‹ï¼Œè¿ç»­é¡µæ•°



**è½åœ°ä»£ç ï¼š**



1. é€šè¿‡å…¬å¼è®¡ç®—å‡ºè¿ç»­é¡µæ•°

   ```js
   computed: {
     // ç®—è¿ç»­é¡µçš„èµ·å§‹é¡µã€ç»“æŸé¡µ
     startEnd() {
       // è·å–åˆ†é¡µå™¨çš„å„ç§å‚æ•°
       const { total, pageSize, pageNum, continues } = this
   
       console.log(total, pageSize)
   
       let start = 0 // è¿ç»­é¡µçš„èµ·å§‹ä½ç½®
       let end = 0 // è¿ç»­é¡µçš„ç»“æŸä½ç½®
   
       start = pageNum - (continues - 1) / 2
       end = pageNum + (continues - 1) / 2
   
       return { start, end }
     }
   }
   ```

   

2. åœ¨é¡µé¢ä¸­å±•ç¤ºå‡ºè¿ç»­åˆ†é¡µ

   ```html
   <button>{{ startEnd.start }}</button>
   <button>xxx</button>
   <button class="active">{{ pageNum }}</button>
   <button>xxx</button>
   <button>{{ startEnd.end }}</button>
   ```







## 14.åˆ†é¡µ-ç®—è¿ç»­é¡µæ•°-ç‰¹æ®Šæƒ…å†µ (1)



**æ€è·¯åˆ†æï¼š**



<font color="red">**ç‰¹æ®Šæƒ…å†µ 1 ï¼šä¼ å…¥çš„ continues > ç®—å‡ºçš„ totalPage**</font>



```shell
ä¾‹å¦‚ 1ï¼š								 	 ä¾‹å¦‚ 2ï¼š

total = 103									total = 103
pageSize = 30								pageSize = 30
pageNum = 3									pageNum = 2
continues = 5								continues = 5

ç»è¿‡è®¡ç®—ï¼štotalPage = 4ï¼Œ					    ç»è¿‡è®¡ç®—ï¼štotalPage = 4ï¼Œ

ã€å½“å‰é¡µç  pageNum ã€‘ ç­‰äº ã€3ã€‘				ã€å½“å‰é¡µç  pageNum ã€‘ ç­‰äº ã€2ã€‘
ã€ç›¸é‚»é¡µç  continuesã€‘ ç­‰äº ã€5ã€‘				ã€ç›¸é‚»é¡µç  continuesã€‘ ç­‰äº ã€5ã€‘

å¯¹äºä¾‹å­ 1ï¼šç›¸é‚»é¡µç åŒºåŸŸå±•ç¤º  1 2 3 4 5 ! ä½†æ˜¯ 5 è¿™ä¸¤ä¸ªé¡µé¢æ˜¯ä¸å­˜åœ¨ â— â— â—
å¯¹äºä¾‹å­ 2ï¼šç›¸é‚»é¡µç åŒºåŸŸå±•ç¤º  0 1 2 3 4 ! ä½†æ˜¯ 0 è¿™ä¸¤ä¸ªé¡µé¢æ˜¯ä¸å­˜åœ¨ â— â— â—
```



è‹¥ï¼š<font color="red">**ä¼ å…¥çš„ continues > ç®—å‡ºçš„ totalPage**</font>

åˆ™ï¼š<font color="green">**èµ·å§‹ä½ç½®ä¸º 1ï¼Œç»“æŸä¸ºä½ç½®ä¸º totalPage**</font>



**å®ç°æ­¥éª¤ï¼š**



1. åœ¨ startEnd è®¡ç®—å±æ€§ä¸­æ–°å¢åˆ¤æ–­ <font color="red">**ä¼ å…¥çš„ continues > ç®—å‡ºçš„ totalPage**</font>



**è½åœ°ä»£ç ï¼š**

```js
computed: {
  // ç®—è¿ç»­é¡µçš„èµ·å§‹é¡µã€ç»“æŸé¡µ
  startEnd() {
    // è·å–åˆ†é¡µå™¨çš„å„ç§å‚æ•°
    const { total, pageSize, pageNum, continues, totalPage } = this

    console.log(total, pageSize)

    let start = 0 // è¿ç»­é¡µçš„èµ·å§‹ä½ç½®
    let end = 0 // è¿ç»­é¡µçš„ç»“æŸä½ç½®

    if (continues > totalPage) {
      start = 1
      end = totalPage
    } else {
      start = pageNum - (continues - 1) / 2
      end = pageNum + (continues - 1) / 2
    }

    return { start, end }
  }
}
```







## 15.åˆ†é¡µ-ç®—è¿ç»­é¡µæ•°-ç‰¹æ®Šæƒ…å†µ (2)



**æ€è·¯åˆ†æï¼š**



<font color="red">**ç‰¹æ®Šæƒ…å†µ 2 ï¼šç®—å‡ºçš„èµ·å§‹ä½ç½® < 1**</font>



```shell
ä¾‹å¦‚ 1ï¼š

total = 103
pageSize = 5
pageNum = 2
continues = 5

ç»è¿‡è®¡ç®—ï¼štotalPage = 21

ã€å½“å‰é¡µç  pageNum ã€‘ ç­‰äºã€2ã€‘
ã€ç›¸é‚»é¡µç  continuesã€‘ ç­‰äº ã€5ã€‘

å¯¹äºä¾‹å­ 1ï¼šç›¸é‚»é¡µç åŒºåŸŸå±•ç¤º  0 1 2 3 4  ! ä½†æ˜¯ 0 è¿™ä¸ªé¡µé¢æ˜¯ä¸å­˜åœ¨ â— â— â—

å› æ­¤éœ€è¦å¾€åè¡¥ä¸€ä½æ‰å¯¹ï¼Œè¡¥ä¸Šåçš„åˆ†é¡µï¼š1 2 3 4 5
```



è‹¥ï¼š<font color="red">**ç®—å‡ºçš„èµ·å§‹ä½ç½® < 1**</font>

åˆ™ï¼š<font color="green">**èµ·å§‹ä½ç½®ä¸º 1ï¼Œç»“æŸä¸ºä½ç½®ä¸º continues**</font>



**å®ç°æ­¥éª¤ï¼š**



1. åœ¨ startEnd è®¡ç®—å±æ€§ä¸­æ–°å¢åˆ¤æ–­ <font color="red">**ç®—å‡ºçš„èµ·å§‹ä½ç½® < 1**</font>



**è½åœ°ä»£ç ï¼š**

```js
computed: {
  // ç®—è¿ç»­é¡µçš„èµ·å§‹é¡µã€ç»“æŸé¡µ
  startEnd() {
    // è·å–åˆ†é¡µå™¨çš„å„ç§å‚æ•°
    const { total, pageSize, pageNum, continues, totalPage } = this

    console.log(total, pageSize)

    let start = 0 // è¿ç»­é¡µçš„èµ·å§‹ä½ç½®
    let end = 0 // è¿ç»­é¡µçš„ç»“æŸä½ç½®

    if (continues > totalPage) {
      start = 1
      end = totalPage
    } else {
      start = pageNum - (continues - 1) / 2
      end = pageNum + (continues - 1) / 2
      
      // åˆ¤æ–­å·¦è¾¹æ˜¯å¦ < 1
      if (start < 1) {
        start = 1
        end = continues
      }
    }

    return { start, end }
  }
}
```







## 16.åˆ†é¡µ-ç®—è¿ç»­é¡µæ•°-ç‰¹æ®Šæƒ…å†µ (3)



**æ€è·¯åˆ†æï¼š**



<font color="red">**ç‰¹æ®Šæƒ…å†µ 3 ï¼šç®—å‡ºçš„ç»“æŸä½ç½® > totalPage**</font>



```shell
ä¾‹å¦‚ ï¼š

total = 103
pageSize = 5
pageNum = 20
continues = 5

ç»è¿‡è®¡ç®—ï¼štotalPage = 21

ã€å½“å‰é¡µç  pageNum ã€‘ ç­‰äºã€20ã€‘
ã€ç›¸é‚»é¡µç  totalPageã€‘ ç­‰äº ã€21ã€‘

å¯¹äºä¾‹å­ï¼šç›¸é‚»é¡µç åŒºåŸŸå±•ç¤º  18 19 20 21 22 ! ä½†æ˜¯ 22 è¿™ä¸ªé¡µé¢æ˜¯ä¸å­˜åœ¨ â— â— â—

å› æ­¤éœ€è¦å¾€å‰è¡¥ä¸€ä½æ‰å¯¹ï¼Œè¡¥ä¸Šåçš„åˆ†é¡µï¼š17 18 19 20 21
```



è‹¥ï¼š<font color="red">**ç®—å‡ºçš„ç»“æŸä½ç½® > totalPage**</font>

åˆ™ï¼š<font color="green">**èµ·å§‹ä½ç½®ä¸º totalPage - continues + 1ï¼Œç»“æŸä¸ºä½ç½®ä¸º totalPage**</font>



**å®ç°æ­¥éª¤ï¼š**



1. åœ¨ startEnd è®¡ç®—å±æ€§ä¸­æ–°å¢åˆ¤æ–­ <font color="red">**ç®—å‡ºçš„ç»“æŸä½ç½® > totalPage**</font>



**è½åœ°ä»£ç ï¼š**

```js
computed: {
  // ç®—è¿ç»­é¡µçš„èµ·å§‹é¡µã€ç»“æŸé¡µ
  startEnd() {
    // è·å–åˆ†é¡µå™¨çš„å„ç§å‚æ•°
    const { total, pageSize, pageNum, continues, totalPage } = this

    console.log(total, pageSize)

    let start = 0 // è¿ç»­é¡µçš„èµ·å§‹ä½ç½®
    let end = 0 // è¿ç»­é¡µçš„ç»“æŸä½ç½®

    if (continues > totalPage) {
      start = 1
      end = totalPage
    } else {
      start = pageNum - (continues - 1) / 2
      end = pageNum + (continues - 1) / 2
      
      // åˆ¤æ–­å·¦è¾¹æ˜¯å¦ < 1
      if (start < 1) {
        start = 1
        end = continues
      }
        
      // åˆ¤æ–­å³è¾¹æ˜¯å¦ > totalPage
      if (end > totalPage) {
        start = totalPage - continues + 1
        end = totalPage
      }
    }

    return { start, end }
  }
}
```







## 17. åˆ†é¡µ-å±•ç¤ºå®Œæ•´è¿ç»­é¡µ



**æ€è·¯åˆ†æï¼š**



å…ˆä¼ªé€ æ•°æ®ï¼Œåˆ©ç”¨ä¼ªé€ çš„æ•°æ®å±•ç¤ºå®Œæ•´è¿ç»­é¡µï¼š

```html
<Pagination :total="103" :pageSize="5" :pageNum="15" :continues="5" />
```



é‚£ä¹ˆéœ€è¦å±•ç¤ºçš„æ•°æ®æ˜¯å®Œæ•´è¿ç»­é¡µæ˜¯ï¼š

```text
									13 14 15 16 17
```



 ä¸èƒ½ç›´æ¥å¯¹ä¼ å…¥çš„ `continues` è¿›è¡Œéå†ï¼Œå› ä¸º  `continues` ä¸å¯é ï¼Œè¿™é‡Œå€ŸåŠ© **å¼€å§‹å’Œç»“æŸä½ç½®** è¿›è¡Œå¤„ç†

```
ä¼ å…¥çš„å½“å‰é¡µç æ˜¯ 15ï¼Œå®Œæ•´è¿ç»­é¡µæ˜¯ 5

å¼€å§‹ä½ç½®æ˜¯ 13ï¼Œç»“æŸä½ç½®æ˜¯ 17

17 - 13 + 1 å°±ç­‰äºå®Œæ•´è¿ç»­é¡µ 5 // éå† 5 æ¬¡
```



éå†çš„å†…å®¹æ€ä¹ˆå¤„ç†

```js
17 - 13 + 1 å°±ç­‰äºå®Œæ•´è¿ç»­é¡µ 5

éå† 5 æ¬¡ï¼Œå¯¹åº”çš„ç´¢å¼•æ˜¯ 0, 1, 2, 3, 4

éå†äº§ç”Ÿçš„å†…å®¹æ˜¯ï¼šstart + ç´¢å¼•

start ç›®å‰æ˜¯ 13

ä¹Ÿå°±æ˜¯ï¼š13+0, 13+1, 13+2, 13+3, 13+4

æœ€ç»ˆç»“æœæ˜¯ï¼š13 14 15 16 17

```







**å®ç°æ­¥éª¤ï¼š**



æŒ‰ç…§åˆ†æçš„å…¬å¼å®ç°å³å¯ 



**è½åœ°ä»£ç ï¼š**

```html
<template>
  <div class="pagination">
    <!-- <button>ä¸Šä¸€é¡µ</button>
    <button>1</button>
    <span>Â·Â·Â·</span> -->

    <!-- <button>{{ startEnd.start }}</button>
    <button>xxx</button>
    <button class="active">{{ pageNum }}</button>
    <button>xxx</button>
    <button>{{ startEnd.end }}</button> -->

    <button
      v-for="(num, index) in startEnd.end - startEnd.start + 1"
      :key="index"
      :class="{ active: pageNum === startEnd.start + index }"
    >
      {{ startEnd.start + index }}
    </button>

    <!-- <span>Â·Â·Â·</span>
    <button>{{ totalPage }}</button>
    <button>ä¸‹ä¸€é¡µ</button> -->

    <span>å…± {{ total }} æ¡</span>
  </div>
</template>
```







## 18.åˆ†é¡µ-æ•´ä½“å±•ç¤º



**æ€è·¯åˆ†æï¼š**



1. å½“å‰å·²ç»æ˜¯ç¬¬ä¸€é¡µäº†ï¼Œé‚£ä¹ˆã€ä¸Šä¸€é¡µã€‘å°±ä¸èƒ½ç‚¹äº†

2. å½“å‰å·²ç»æ˜¯æœ€åä¸€é¡µäº†ï¼Œé‚£ä¹ˆã€ä¸‹ä¸€é¡µã€‘å°±ä¸èƒ½ç‚¹äº†
3. ä¸¤ä¸ªæ•°ä¸­é—´ï¼Œæœ‰å…¶ä»–æ•°ï¼Œå†å‡ºç°ä¸‰ä¸ªç‚¹ã€‚

**å®ç°æ­¥éª¤ï¼š**

**è½åœ°ä»£ç ï¼š**



```html
<template>
  <div class="pagination">
    <!-- å½“å‰å·²ç»æ˜¯ç¬¬ä¸€é¡µäº†ï¼Œé‚£ä¹ˆã€ä¸Šä¸€é¡µã€‘å°±ä¸èƒ½ç‚¹äº† -->
    <button :disabled="pageNum === 1">ä¸Šä¸€é¡µ</button>
    <button v-if="startEnd.start !== 1">1</button>
    <!-- ä¸¤ä¸ªæ•°ä¸­é—´ï¼Œæœ‰å…¶ä»–æ•°ï¼Œå†å‡ºç°ä¸‰ä¸ªç‚¹ -->
    <span v-if="startEnd.start > 2">Â·Â·Â·</span>

    <button
      v-for="(num, index) in startEnd.end - startEnd.start + 1"
      :key="index"
      :class="{ active: pageNum === startEnd.start + index }"
    >
      {{ startEnd.start + index }}
    </button>

    <!-- ä¸¤ä¸ªæ•°ä¸­é—´ï¼Œæœ‰å…¶ä»–æ•°ï¼Œå†å‡ºç°ä¸‰ä¸ªç‚¹ -->
    <span v-if="startEnd.end < totalPage - 1">Â·Â·Â·</span>
    <button v-if="startEnd.end !== totalPage">{{ totalPage }}</button>
    <!-- å½“å‰å·²ç»æ˜¯æœ€åä¸€é¡µäº†ï¼Œé‚£ä¹ˆã€ä¸‹ä¸€é¡µã€‘å°±ä¸èƒ½ç‚¹äº† -->
    <button :disabled="pageNum === totalPage">ä¸‹ä¸€é¡µ</button>

    <span>å…± {{ total }} æ¡</span>
  </div>
</template>
```







## 19. åˆ†é¡µ-ä¼ é€’çœŸå®æ•°æ®



**æ€è·¯åˆ†æï¼š**





**å®ç°æ­¥éª¤ï¼š**



1. åœ¨`Search`ç»„ä»¶ä»`vuex`ä¸­è·å–æœåŠ¡å™¨è¿”å›çš„`total`ï¼Œä¼ é€’ç»™`Pagination`ç»„ä»¶
2. å°†æŒ‡å®šçš„ `pageSize`ã€`pageNum`ä¼ é€’ç»™`Pagination`ç»„ä»¶



**è½åœ°ä»£ç ï¼š**



1. åœ¨`Search`ç»„ä»¶ä»`vuex`ä¸­è·å–æœåŠ¡å™¨è¿”å›çš„`total`ï¼Œä¼ é€’ç»™`Pagination`ç»„ä»¶

   ```js
   computed: {
     ...mapState({
       goodsList: (state) => state.search.searchInfo.goodsList,
       total: (state) => state.search.searchInfo.total
     })
   }
   ```

   

2. å°†æŒ‡å®šçš„ `pageSize`ã€`pageNum`ä¼ é€’ç»™`Pagination`ç»„ä»¶

   ```html
   <Pagination
     :total="total"
     :pageSize="searchParams.pageSize"
     :pageNum="searchParams.pageNum"
     :continues="5"
   />
   ```

   





## 20. åˆ†é¡µ-æ•´ä½“äº¤äº’



**æ€è·¯åˆ†æï¼š**

<img src="./images/5-7 åˆ†é¡µ.png" style="zoom:80%; border: 1px solid #ccc" />



ç»™æ¯ä¸ªæŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼ŒåŒæ—¶æŠŠé¡µé¢ä¼ é€’ç»™çˆ¶ç»„ä»¶ï¼Œè®©çˆ¶ç»„ä»¶è¯·æ±‚å¯¹åº”é¡µé¢çš„æ•°æ®



**å®ç°æ­¥éª¤ï¼š**

**è½åœ°ä»£ç ï¼š**



1.  ç»™æ¯ä¸ªæŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼ŒåŒæ—¶æŠŠé¡µé¢ä¼ é€’ç»™çˆ¶ç»„ä»¶

   ```html
   <template>
     <div class="pagination">
       <!-- å½“å‰å·²ç»æ˜¯ç¬¬ä¸€é¡µäº†ï¼Œé‚£ä¹ˆã€ä¸Šä¸€é¡µã€‘å°±ä¸èƒ½ç‚¹äº† -->
       <button @click="changePageNum(pageNum - 1)" :disabled="pageNum === 1">ä¸Šä¸€é¡µ</button>
       <button @click="changePageNum(1)" v-if="startEnd.start !== 1">1</button>
       <!-- ä¸¤ä¸ªæ•°ä¸­é—´ï¼Œæœ‰å…¶ä»–æ•°ï¼Œå†å‡ºç°ä¸‰ä¸ªç‚¹ -->
       <span v-if="startEnd.start > 2">Â·Â·Â·</span>
   
       <button
         v-for="(num, index) in startEnd.end - startEnd.start + 1"
         :key="index"
         :class="{ active: pageNum === startEnd.start + index }"
         @click="changePageNum(startEnd.start + index)"
       >
         {{ startEnd.start + index }}
       </button>
   
       <!-- ä¸¤ä¸ªæ•°ä¸­é—´ï¼Œæœ‰å…¶ä»–æ•°ï¼Œå†å‡ºç°ä¸‰ä¸ªç‚¹ -->
       <span v-if="startEnd.end < totalPage - 1">Â·Â·Â·</span>
       <button v-if="startEnd.end !== totalPage" @click="changePageNum(totalPage)">{{ totalPage }}</button>
       <!-- å½“å‰å·²ç»æ˜¯æœ€åä¸€é¡µäº†ï¼Œé‚£ä¹ˆã€ä¸‹ä¸€é¡µã€‘å°±ä¸èƒ½ç‚¹äº† -->
       <button :disabled="pageNum === totalPage" @click="changePageNum(pageNum + 1)">ä¸‹ä¸€é¡µ</button>
   
       <span>å…± {{ total }} æ¡</span>
     </div>
   </template>
   ```

   ```vue
   <script>
   export default {
     methods: {
       changePageNum(newPage) {
         this.$emit('changePageNum', newPage)
       }
     }
   }
   </script>
   ```

   

2. çˆ¶ç»„ä»¶æ¥æ”¶æ•°æ®ï¼Œä¼ é€’ç»™ `searchParams` ä¸­çš„ `pageNum`

   ```html
   <!-- åˆ†é¡µå™¨ -->
   <div class="pagination">
     <Pagination
       :total="total"
       :pageSize="searchParams.pageSize"
       :pageNum="searchParams.pageNum"
       :continues="5"
       @changePageNum="getPageNum"
     />
   </div>
   ```

   ```js
   methods: {
     getPageNum(newNum) {
       this.searchParams.pageNum = newNum
     }
   }
   ```







##  21. åˆ†é¡µ-åˆ‡æ¢åˆ†ç±»æ—¶çš„ Bug



**æ€è·¯åˆ†æï¼š**



æœç´¢å•†å“æ—¶ï¼Œå•†å“åˆ†ç±»ã€å“ç‰Œã€å±æ€§ã€å…³é”®è¯è‹¥å˜åŒ–ï¼Œ`pageNum`åº”è¯¥é‡ç½®ä¸º1ï¼Œå› ä¸ºè¿™äº›åŠ¨ä½œä¼šå¼•èµ·åˆ—è¡¨æ•°é‡çš„å˜åŒ–ï¼Œå¦‚æœä¸é‡ç½®ï¼Œä¼šå¯¼è‡´åˆ†é¡µçš„é”™ä¹±



**å®ç°æ­¥éª¤ï¼š**



åœ¨å•†å“åˆ†ç±»ã€å“ç‰Œã€å±æ€§ã€å…³é”®è¯å¯¹åº”çš„æ–¹æ³•ä¸­ï¼Œå°†`pageNum`åº”è¯¥é‡ç½®ä¸º1



**è½åœ°ä»£ç ï¼š**

```vue
export default {
  name: 'SearchPage',
  data() {
    return {
      // coding....
    }
  },
  methods: {
    getPageNum(newNum) {
      this.searchParams.pageNum = newNum
    },

    // é¢åŒ…å±‘-ç§»é™¤åˆ†ç±»å
    removeCategoryName() {
      // coding....

      this.searchParams.pageNum = 1
    },

    // é¢åŒ…å±‘-ç§»é™¤å…³é”®å­—
    removeKeyword() {
      // coding....
      
      this.searchParams.pageNum = 1
    },

    // é¢åŒ…å±‘-ç§»é™¤å“ç‰Œå
    removeTrademark() {
      // coding....
        
      this.searchParams.pageNum = 1
    },

    // é¢åŒ…å±‘-æ¸…é™¤å±æ€§å
    removeProps(index) {
      // coding....
        
      this.searchParams.pageNum = 1
    },

    // ç”¨äºæ¥æ”¶ SearchSelector å­ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å“ç‰Œæ•°æ®
    saveTrademark(trademark) {
      // coding....
        
      this.searchParams.pageNum = 1
    },

    // ç”¨äºæ¥æ”¶ SearchSelector å­ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å±æ€§æ•°æ®
    saveAttr(attrs, attrValue) {
      // coding....

      this.searchParams.pageNum = 1
    },

    // ä¸“é—¨ç”¨äºæ ¼å¼åŒ–æ¯ä¸ªå•†å“å±æ€§çš„æ–¹æ³•
    // coding....
  },
  watch: {
    $route: {
      async handler(route) {
        // éœ€è¦é‡ç½®çš„ query å‚æ•°æ•°æ®
        const resetObj = { 
          category1Id: '',
          category2Id: '',
          category3Id: '',
          categoryName: '',
          keyword: '',
          pageNum: 1
         }

        // å°†éœ€è¦é‡ç½®çš„ query å‚æ•°æ•°æ®ï¼Œå¹¶å°†æœ€æ–°å‚æ•°åˆå¹¶è¿›å»
        Object.assign(this.searchParams, resetObj, route.query)

        this.$store.dispatch('search/getSearchInfo', this.searchParams)
      },
      immediate: true
    },
  }
}
</script>
```









## 21. åˆ†é¡µ-æ•°æ®ä¸ºç©ºæ—¶çš„ä¼˜åŒ–



**æ€è·¯åˆ†æï¼š**



æœç´¢æ²¡æœ‰ç»“æœæ—¶ï¼Œç»™ç”¨æˆ·è¿›è¡Œæç¤º



**å®ç°æ­¥éª¤ï¼š**



**è½åœ°ä»£ç ï¼š**

```html
<!-- æœç´¢å™¨ -->
<SearchSelector v-show="total" ****** />

<!--å•†å“å±•ç¤ºåŒº-->
<div class="details clearfix" v-if="total">
</div>

<!-- æ•°æ®ä¸ºç©ºçš„å±•ç¤º -->
<div v-show="!total" class="empty">
  <img src="xxxxxxx" alt="">
  <h1>æŠ±æ­‰ï¼Œæœç´¢ç»“æœä¸ºç©ºï¼</h1>
</div>
```













**æ€è·¯åˆ†æï¼š**

**å®ç°æ­¥éª¤ï¼š**

**è½åœ°ä»£ç ï¼š**





